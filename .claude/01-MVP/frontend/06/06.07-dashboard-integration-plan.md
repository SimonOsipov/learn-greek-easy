# Task 06.07: Enhance Dashboard Page - Implementation Plan

**Status**: âœ… **COMPLETED**
**Duration**: 60 minutes (Actual: 60 minutes)
**Completed**: 2025-11-05
**Priority**: High
**Dependencies**: Tasks 06.01-06.06 (All Complete)
**Created**: 2025-11-05

---

## Task Overview

### Objective

Integrate all analytics components (charts, widgets, activity feed) built in tasks 06.01-06.06 into the Dashboard page, replacing the current placeholder/mock data with real analytics from `analyticsStore`. Transform the static Dashboard into a fully functional analytics dashboard that visualizes user learning progress with live data.

### Business Value

- **User Motivation**: Visual progress tracking encourages continued learning
- **Insight Generation**: Users can identify strengths/weaknesses across decks
- **Habit Formation**: Streak tracking and activity feed reinforce daily practice
- **Progress Transparency**: Clear metrics show concrete progress toward exam readiness

### Success Metrics

- Dashboard displays real user analytics (not placeholder data)
- All charts render correctly with data from analyticsStore
- Date range filter updates all components synchronously
- Responsive layout works across mobile (375px), tablet (768px), desktop (1024px+)
- Loading states display smoothly during data fetch
- No TypeScript errors, build succeeds

---

## Current State Analysis

### Existing Dashboard.tsx Structure

**Location**: `/Users/samosipov/Downloads/learn-greek-easy/learn-greek-easy-frontend/src/pages/Dashboard.tsx`

**Current Implementation** (219 lines):
- Uses mock data defined in `mockDashboardData` constant
- Contains 3 main sections:
  1. **WelcomeSection** - Greek greeting, due count, streak, CTA button
  2. **Metrics Grid** - 5 MetricCards (Due Today, Streak, Mastered, Accuracy, Time)
  3. **Active Decks Section** - 2 DeckCards with progress
  4. **Configuration Test Section** - Setup verification (can be removed)

**Components Currently Used**:
- `WelcomeSection` - Keep, update props with real data
- `MetricCard` - Keep, replace with analytics metrics
- `DeckCard` - Keep in separate section below analytics
- `Card`, `Separator` - UI components, keep using

**What Needs to Change**:
1. Remove `mockDashboardData` constant and all mock data
2. Add `analyticsStore` integration with `useEffect` hook
3. Replace 5 placeholder MetricCards with analytics-driven metrics
4. Add DateRangeFilter component at top
5. Add Charts section (4 charts in responsive grid)
6. Add Analytics Widgets section (4 widgets)
7. Add Activity Feed section
8. Add loading skeleton for initial data fetch
9. Add error state handling (Alert component)
10. Optionally keep or remove "Configuration Test Section" (recommended: remove)

---

## Available Components Reference

### Analytics Store (Data Source)

**Import**: `import { useAnalyticsStore } from '@/stores/analyticsStore';`

**Store Shape**:
```typescript
interface AnalyticsState {
  dashboardData: AnalyticsDashboardData | null;
  dateRange: DateRangeType; // 'last7' | 'last30' | 'alltime'
  loading: boolean;
  refreshing: boolean;
  error: string | null;
  lastFetch: number | null;

  // Actions
  loadAnalytics: (userId: string, dateRange?: DateRangeType) => Promise<void>;
  setDateRange: (range: DateRangeType) => void;
  refreshAnalytics: () => Promise<void>;
  clearAnalytics: () => void;
}
```

**Selectors Available**:
```typescript
import {
  selectDashboardData,
  selectProgressData,
  selectDeckPerformance,
  selectStudyStreak,
  selectRecentActivity,
  selectIsLoading,
  selectError,
  selectDateRange
} from '@/stores/analyticsStore';
```

### Chart Components

**Import**: `import { ProgressLineChart, AccuracyAreaChart, DeckPerformanceChart, StageDistributionChart } from '@/components/charts';`

1. **ProgressLineChart** - Line chart showing cards reviewed over time
   - Props: Takes data from analyticsStore progressData
   - Responsive, includes tooltips

2. **AccuracyAreaChart** - Area chart showing accuracy trend
   - Props: Takes data from analyticsStore progressData
   - Color-coded by performance level

3. **DeckPerformanceChart** - Bar chart comparing deck accuracy
   - Props: Takes data from analyticsStore deckStats
   - Shows all decks side-by-side

4. **StageDistributionChart** - Donut chart showing card status breakdown
   - Props: Takes data from analyticsStore wordStatus
   - 4 segments: New, Learning, Review, Mastered

### Analytics Widget Components

**Import**: `import { StreakWidget, WordStatusWidget, RetentionWidget, TimeStudiedWidget } from '@/components/analytics';`

1. **StreakWidget** - Displays current study streak with flame icon
   - Props: `streak: StudyStreak`

2. **WordStatusWidget** - Shows total words mastered with trophy icon
   - Props: `wordStatus: WordStatusBreakdown`

3. **RetentionWidget** - Displays retention rate percentage
   - Props: `retention: RetentionRate[]`

4. **TimeStudiedWidget** - Shows total time studied formatted
   - Props: `timeMinutes: number`

### Activity Feed Component

**Import**: `import { ActivityFeed } from '@/components/analytics';`

- Props: `activities: AnalyticsActivityItem[]`, `maxItems?: number`
- Displays recent review sessions
- Includes empty state handling
- Items are clickable (navigate to deck detail)

### Existing Display Components (Keep Using)

- `WelcomeSection` - Update with real streak data
- `MetricCard` - Can reuse for top metrics row
- `DeckCard` - Keep for "Active Decks" section

---

## Implementation Plan

### Step 1: Backup and Setup (2 minutes)

**Actions**:
1. Create backup of current Dashboard.tsx
2. Review completed analytics components structure

**Commands**:
```bash
cd /Users/samosipov/Downloads/learn-greek-easy/learn-greek-easy-frontend
cp src/pages/Dashboard.tsx src/pages/Dashboard.backup.tsx
```

**Verification**:
- Backup file exists at `src/pages/Dashboard.backup.tsx`

---

### Step 2: Update Imports Section (5 minutes)

**Actions**:
1. Remove unused imports (DashboardData type, mock data)
2. Add analyticsStore imports
3. Add chart component imports
4. Add analytics widget imports
5. Add activity feed import
6. Add necessary hooks (useEffect, useNavigate)
7. Add auth store for userId

**New Imports to Add**:
```typescript
import React, { useEffect } from 'react';
import { useNavigate } from 'react-router-dom';
import { useAuthStore } from '@/stores/authStore';
import { useAnalyticsStore, selectDashboardData, selectIsLoading, selectError, selectDateRange } from '@/stores/analyticsStore';
import type { DateRangeType } from '@/stores/analyticsStore';

// Existing display components (keep)
import { WelcomeSection } from '@/components/display/WelcomeSection';
import { MetricCard } from '@/components/display/MetricCard';

// Chart components (new)
import {
  ProgressLineChart,
  AccuracyAreaChart,
  DeckPerformanceChart,
  StageDistributionChart
} from '@/components/charts';

// Analytics widgets (new)
import {
  StreakWidget,
  WordStatusWidget,
  RetentionWidget,
  TimeStudiedWidget,
  ActivityFeed
} from '@/components/analytics';

// UI components (keep)
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Separator } from '@/components/ui/separator';
import { Skeleton } from '@/components/ui/skeleton';
import { Alert, AlertDescription, AlertTitle } from '@/components/ui/alert';
import { Button } from '@/components/ui/button';

// Icons (new)
import { AlertCircle, BookOpen, Target, TrendingUp, Clock, BarChart3 } from 'lucide-react';
```

**Verification**:
- No TypeScript import errors
- All components available

---

### Step 3: Remove Mock Data and Setup State (3 minutes)

**Actions**:
1. Delete `mockDashboardData` constant entirely
2. Set up store hooks in component
3. Destructure needed values from stores

**Replace This**:
```typescript
const mockDashboardData: DashboardData = {
  // ... 98 lines of mock data
};

export const Dashboard: React.FC = () => {
  const { user, metrics, decks } = mockDashboardData;
  // ...
}
```

**With This**:
```typescript
export const Dashboard: React.FC = () => {
  const navigate = useNavigate();

  // Auth store - get userId
  const { user } = useAuthStore();

  // Analytics store - get dashboard data and actions
  const dashboardData = useAnalyticsStore(selectDashboardData);
  const isLoading = useAnalyticsStore(selectIsLoading);
  const error = useAnalyticsStore(selectError);
  const dateRange = useAnalyticsStore(selectDateRange);
  const { loadAnalytics, setDateRange } = useAnalyticsStore();

  // Fetch analytics on mount
  useEffect(() => {
    if (user?.id) {
      loadAnalytics(user.id);
    }
  }, [user?.id, loadAnalytics]);

  // ... rest of component
}
```

**Verification**:
- No TypeScript errors
- Store hooks properly typed

---

### Step 4: Create Date Range Filter Component Inline (8 minutes)

**Actions**:
1. Create DateRangeFilter as a small component at top of Dashboard component
2. Add button group with 3 options: "Last 7 Days", "Last 30 Days", "All Time"
3. Highlight active button based on current dateRange
4. Call setDateRange() on button click

**Implementation**:
```typescript
// Helper to get date range label
const getDateRangeLabel = (range: DateRangeType): string => {
  switch (range) {
    case 'last7': return 'Last 7 Days';
    case 'last30': return 'Last 30 Days';
    case 'alltime': return 'All Time';
    default: return 'Last 30 Days';
  }
};

// Inside Dashboard component, before return statement
const handleDateRangeChange = (newRange: DateRangeType) => {
  setDateRange(newRange);
};

const dateRangeOptions: DateRangeType[] = ['last7', 'last30', 'alltime'];
```

**JSX for Date Range Filter** (add near top of return statement):
```tsx
{/* Date Range Filter */}
<div className="flex items-center justify-between mb-6">
  <h2 className="text-lg font-semibold text-text-primary">Analytics Overview</h2>
  <div className="flex gap-2">
    {dateRangeOptions.map((option) => (
      <Button
        key={option}
        variant={dateRange === option ? 'default' : 'outline'}
        size="sm"
        onClick={() => handleDateRangeChange(option)}
        className="min-w-[100px]"
      >
        {getDateRangeLabel(option)}
      </Button>
    ))}
  </div>
</div>
```

**Verification**:
- Buttons render correctly
- Active button highlighted
- Clicking button triggers setDateRange()

---

### Step 5: Replace Placeholder Metrics with Real Analytics (10 minutes)

**Actions**:
1. Keep WelcomeSection but update props with real data
2. Replace 5 MetricCard components with analytics-driven metrics
3. Extract values from dashboardData.summary and dashboardData.streak

**Replace WelcomeSection**:
```tsx
{/* Welcome Section - Update with real data */}
<WelcomeSection
  userName={user?.name || 'Student'}
  dueCount={dashboardData?.summary.totalCardsReviewed || 0}
  streak={dashboardData?.streak.currentStreak || 0}
  onStartReview={() => navigate('/review')}
/>
```

**Replace Metrics Grid**:
```tsx
{/* Top Metrics Row */}
<section>
  <h2 className="mb-4 text-lg font-semibold text-text-primary">Your Progress</h2>
  <div className="grid grid-cols-2 gap-4 md:grid-cols-3 lg:grid-cols-5">
    <MetricCard
      label="Cards Reviewed"
      value={dashboardData?.summary.totalCardsReviewed || 0}
      sublabel={getDateRangeLabel(dateRange)}
      color="primary"
      icon="ðŸ“š"
    />
    <MetricCard
      label="Current Streak"
      value={dashboardData?.streak.currentStreak || 0}
      sublabel="days in a row"
      color="orange"
      icon="ðŸ”¥"
    />
    <MetricCard
      label="Cards Mastered"
      value={dashboardData?.wordStatus.mastered || 0}
      sublabel="total words"
      color="green"
      icon="âœ…"
    />
    <MetricCard
      label="Accuracy"
      value={`${Math.round(dashboardData?.summary.averageAccuracy || 0)}%`}
      sublabel={getDateRangeLabel(dateRange)}
      color="blue"
      icon="ðŸŽ¯"
    />
    <MetricCard
      label="Time Studied"
      value={formatTimeStudied(dashboardData?.summary.totalTimeStudied || 0)}
      sublabel={getDateRangeLabel(dateRange)}
      color="muted"
      icon="â±ï¸"
    />
  </div>
</section>
```

**Helper Function for Time Formatting**:
```typescript
// Add before component
const formatTimeStudied = (seconds: number): string => {
  const hours = Math.floor(seconds / 3600);
  const minutes = Math.floor((seconds % 3600) / 60);
  if (hours > 0) {
    return `${hours}h ${minutes}m`;
  }
  return `${minutes}m`;
};
```

**Verification**:
- Metrics display real values from analyticsStore
- Values update when date range changes
- Formatting correct (time, percentage)

---

### Step 6: Add Charts Section (12 minutes)

**Actions**:
1. Add new section after metrics for charts
2. Create responsive grid (1 column mobile, 2 columns desktop)
3. Add all 4 chart components with data from analyticsStore

**JSX for Charts Section**:
```tsx
<Separator className="my-6" />

{/* Charts Section */}
<section>
  <h2 className="mb-4 text-lg font-semibold text-text-primary">Progress Analytics</h2>
  <div className="grid grid-cols-1 gap-6 lg:grid-cols-2">
    {/* Progress Line Chart */}
    <Card>
      <CardHeader>
        <CardTitle className="flex items-center gap-2">
          <TrendingUp className="h-5 w-5 text-primary" />
          Cards Reviewed Over Time
        </CardTitle>
        <CardDescription>
          Daily review activity for {getDateRangeLabel(dateRange).toLowerCase()}
        </CardDescription>
      </CardHeader>
      <CardContent>
        {dashboardData?.progressData && dashboardData.progressData.length > 0 ? (
          <ProgressLineChart />
        ) : (
          <div className="flex h-[300px] items-center justify-center text-text-muted">
            <div className="text-center">
              <BookOpen className="mx-auto h-12 w-12 text-text-subtle" />
              <p className="mt-2">No review data yet</p>
              <p className="text-sm">Start reviewing to see your progress</p>
            </div>
          </div>
        )}
      </CardContent>
    </Card>

    {/* Accuracy Area Chart */}
    <Card>
      <CardHeader>
        <CardTitle className="flex items-center gap-2">
          <Target className="h-5 w-5 text-success" />
          Accuracy Trend
        </CardTitle>
        <CardDescription>
          Review accuracy over time
        </CardDescription>
      </CardHeader>
      <CardContent>
        {dashboardData?.progressData && dashboardData.progressData.length > 0 ? (
          <AccuracyAreaChart />
        ) : (
          <div className="flex h-[300px] items-center justify-center text-text-muted">
            <div className="text-center">
              <Target className="mx-auto h-12 w-12 text-text-subtle" />
              <p className="mt-2">No accuracy data yet</p>
            </div>
          </div>
        )}
      </CardContent>
    </Card>

    {/* Deck Performance Chart */}
    <Card>
      <CardHeader>
        <CardTitle className="flex items-center gap-2">
          <BarChart3 className="h-5 w-5 text-info" />
          Deck Performance
        </CardTitle>
        <CardDescription>
          Accuracy comparison across decks
        </CardDescription>
      </CardHeader>
      <CardContent>
        {dashboardData?.deckStats && dashboardData.deckStats.length > 0 ? (
          <DeckPerformanceChart />
        ) : (
          <div className="flex h-[300px] items-center justify-center text-text-muted">
            <div className="text-center">
              <BarChart3 className="mx-auto h-12 w-12 text-text-subtle" />
              <p className="mt-2">No deck data available</p>
            </div>
          </div>
        )}
      </CardContent>
    </Card>

    {/* Stage Distribution Chart */}
    <Card>
      <CardHeader>
        <CardTitle className="flex items-center gap-2">
          <BookOpen className="h-5 w-5 text-warning" />
          Card Status Distribution
        </CardTitle>
        <CardDescription>
          Breakdown by learning stage
        </CardDescription>
      </CardHeader>
      <CardContent>
        {dashboardData?.wordStatus ? (
          <StageDistributionChart />
        ) : (
          <div className="flex h-[300px] items-center justify-center text-text-muted">
            <div className="text-center">
              <BookOpen className="mx-auto h-12 w-12 text-text-subtle" />
              <p className="mt-2">No card status data</p>
            </div>
          </div>
        )}
      </CardContent>
    </Card>
  </div>
</section>
```

**Verification**:
- All 4 charts render without errors
- Charts display data correctly
- Empty states show when no data
- Responsive grid works (2 columns on desktop, 1 on mobile)

---

### Step 7: Add Analytics Widgets Section (8 minutes)

**Actions**:
1. Add new section for analytics widgets
2. Create responsive grid (2 columns mobile, 4 columns desktop)
3. Add 4 widget components

**JSX for Widgets Section**:
```tsx
<Separator className="my-6" />

{/* Analytics Widgets Section */}
<section>
  <h2 className="mb-4 text-lg font-semibold text-text-primary">Key Metrics</h2>
  <div className="grid grid-cols-2 gap-4 md:grid-cols-4">
    {dashboardData && (
      <>
        <StreakWidget streak={dashboardData.streak} />
        <WordStatusWidget wordStatus={dashboardData.wordStatus} />
        <RetentionWidget retention={dashboardData.retention} />
        <TimeStudiedWidget timeMinutes={Math.floor(dashboardData.summary.totalTimeStudied / 60)} />
      </>
    )}
  </div>
</section>
```

**Verification**:
- 4 widgets render correctly
- Data displays accurately
- Icons visible and styled
- Responsive grid works

---

### Step 8: Add Activity Feed Section (6 minutes)

**Actions**:
1. Add new section for recent activity
2. Add ActivityFeed component
3. Limit to 10 most recent items

**JSX for Activity Feed**:
```tsx
<Separator className="my-6" />

{/* Activity Feed Section */}
<section>
  <div className="mb-4 flex items-center justify-between">
    <h2 className="text-lg font-semibold text-text-primary">Recent Activity</h2>
    <Button variant="ghost" size="sm" onClick={() => navigate('/history')}>
      View all â†’
    </Button>
  </div>
  {dashboardData?.recentActivity ? (
    <ActivityFeed activities={dashboardData.recentActivity} maxItems={10} />
  ) : (
    <Card>
      <CardContent className="flex h-[200px] items-center justify-center">
        <div className="text-center text-text-muted">
          <BookOpen className="mx-auto h-12 w-12 text-text-subtle" />
          <p className="mt-2">No recent activity</p>
          <p className="text-sm">Complete a review session to see activity here</p>
        </div>
      </CardContent>
    </Card>
  )}
</section>
```

**Verification**:
- Activity feed displays recent sessions
- Empty state shows when no activity
- Items are clickable

---

### Step 9: Add Loading and Error States (8 minutes)

**Actions**:
1. Add loading skeleton for initial fetch
2. Add error alert component
3. Ensure smooth transitions

**Loading State JSX** (add at top of return, before any content):
```tsx
{/* Loading State - Show skeleton while fetching */}
{isLoading && !dashboardData && (
  <div className="space-y-6 pb-8">
    {/* Welcome Section Skeleton */}
    <div className="mb-8">
      <Skeleton className="h-8 w-64 mb-2" />
      <Skeleton className="h-4 w-96" />
    </div>

    {/* Metrics Skeleton */}
    <div className="grid grid-cols-2 gap-4 md:grid-cols-3 lg:grid-cols-5">
      {[...Array(5)].map((_, i) => (
        <Card key={i} className="p-6">
          <CardContent className="space-y-2 p-0">
            <Skeleton className="h-4 w-24" />
            <Skeleton className="h-8 w-16" />
            <Skeleton className="h-3 w-32" />
          </CardContent>
        </Card>
      ))}
    </div>

    {/* Charts Skeleton */}
    <div className="grid grid-cols-1 gap-6 lg:grid-cols-2">
      {[...Array(4)].map((_, i) => (
        <Card key={i}>
          <CardHeader>
            <Skeleton className="h-6 w-48" />
            <Skeleton className="h-4 w-64" />
          </CardHeader>
          <CardContent>
            <Skeleton className="h-[300px] w-full" />
          </CardContent>
        </Card>
      ))}
    </div>
  </div>
)}
```

**Error State JSX** (add after loading state):
```tsx
{/* Error State - Show alert if fetch failed */}
{error && !isLoading && (
  <Alert variant="destructive" className="mb-6">
    <AlertCircle className="h-4 w-4" />
    <AlertTitle>Failed to Load Analytics</AlertTitle>
    <AlertDescription>
      {error}
      <Button
        variant="outline"
        size="sm"
        className="ml-4"
        onClick={() => user?.id && loadAnalytics(user.id)}
      >
        Retry
      </Button>
    </AlertDescription>
  </Alert>
)}
```

**Wrap Main Content**:
```tsx
{/* Main Dashboard Content - Only show when data loaded */}
{!isLoading && dashboardData && (
  <div className="space-y-6 pb-8">
    {/* All existing sections go here */}
  </div>
)}
```

**Verification**:
- Loading skeleton displays on mount
- Error alert appears if fetch fails
- Retry button refetches data
- Content appears smoothly after load

---

### Step 10: Remove or Keep Configuration Test Section (2 minutes)

**Decision Point**:
- **Option A (Recommended)**: Remove configuration test section entirely (it was only for setup verification in Task 02.08)
- **Option B**: Keep it temporarily for debugging, remove before final merge

**If Removing** (recommended):
```typescript
// DELETE lines 155-216 in current Dashboard.tsx
// (The entire "Configuration Test Section")
```

**If Keeping**: Move to bottom of dashboard, after Activity Feed

**Verification**:
- Dashboard cleaner without test section
- All production sections visible

---

### Step 11: Responsive Layout Verification (8 minutes)

**Actions**:
1. Test layout at key breakpoints
2. Verify grids collapse correctly
3. Ensure no horizontal scroll
4. Check touch target sizes

**Breakpoints to Test**:
- **Mobile (375px)**: All sections stack vertically, charts readable
- **Tablet (768px)**: Metrics 3-column, charts 1-column, widgets 2-column
- **Desktop (1024px)**: Metrics 5-column, charts 2-column, widgets 4-column
- **Large Desktop (1440px+)**: Same as 1024px, with more spacing

**Grid Classes Used** (verify these are correct):
```typescript
// Metrics: 2-col mobile â†’ 3-col tablet â†’ 5-col desktop
className="grid grid-cols-2 gap-4 md:grid-cols-3 lg:grid-cols-5"

// Charts: 1-col mobile/tablet â†’ 2-col desktop
className="grid grid-cols-1 gap-6 lg:grid-cols-2"

// Widgets: 2-col mobile â†’ 4-col desktop
className="grid grid-cols-2 gap-4 md:grid-cols-4"
```

**Verification Commands**:
```bash
# Start dev server
npm run dev

# Open browser to http://localhost:5173/dashboard
# Use browser DevTools responsive mode to test breakpoints
```

**Verification Checklist**:
- [ ] Mobile (375px): All content readable, no horizontal scroll
- [ ] Tablet (768px): Proper grid layouts, charts not squished
- [ ] Desktop (1024px): Full multi-column layout, optimal spacing
- [ ] Touch targets â‰¥ 44px on mobile (buttons, cards)
- [ ] Charts scale proportionally with container

---

### Step 12: Final Testing and Verification (8 minutes)

**Actions**:
1. Test complete user flow
2. Verify all data connections
3. Check console for errors
4. Test date range filtering
5. Validate TypeScript compilation

**Test Scenarios**:

1. **Initial Load**:
   - Navigate to /dashboard
   - Loading skeleton appears briefly
   - Dashboard loads with all sections
   - No console errors

2. **Date Range Filtering**:
   - Click "Last 7 Days" button
   - All charts update with filtered data
   - Metrics recalculate correctly
   - Active button highlighted

3. **Empty State Handling**:
   - Test with new user (no review history)
   - Empty states display with helpful messages
   - No broken components

4. **Navigation**:
   - Click activity feed item â†’ navigates to deck detail
   - Click "Start Review Session" â†’ navigates to review page
   - Click deck card â†’ navigates to deck detail

5. **Error Handling**:
   - Simulate API error (disconnect network)
   - Error alert displays
   - Retry button refetches data

**Commands for Verification**:
```bash
# TypeScript check
npx tsc --noEmit

# Build check
npm run build

# Run dev server
npm run dev
```

**Success Criteria Checklist**:
- [ ] TypeScript: 0 errors
- [ ] Build: SUCCESS (no warnings)
- [ ] Dashboard loads in < 2 seconds
- [ ] All 4 charts render correctly
- [ ] All 4 widgets display data
- [ ] Activity feed shows recent sessions
- [ ] Date range filter updates all components
- [ ] Loading state smooth and brief
- [ ] Error state handles failures gracefully
- [ ] Responsive layout works at all breakpoints
- [ ] No console errors or warnings
- [ ] Navigation works from all clickable elements

---

## Files to Modify

### 1. `/src/pages/Dashboard.tsx`

**Changes**: Complete rewrite (~350 lines, up from 219 lines)

**Sections Added**:
- Date range filter component inline
- Real data integration with analyticsStore
- Charts section (4 charts)
- Widgets section (4 widgets)
- Activity feed section
- Loading skeleton
- Error alert

**Sections Modified**:
- WelcomeSection props (use real data)
- Metrics grid (replace with analytics data)

**Sections Removed**:
- Mock data constant (98 lines)
- Configuration test section (62 lines) - optional

**Imports Added**: ~25 new imports (stores, chart components, widgets, icons)

---

## Success Criteria (Acceptance Criteria)

### Functional Requirements

- [ ] **F1**: Dashboard fetches analytics on mount using `loadAnalytics(userId)`
- [ ] **F2**: Date range filter updates all charts and metrics synchronously
- [ ] **F3**: All metrics display real data from analyticsStore (not placeholders)
- [ ] **F4**: WelcomeSection shows real streak and due count
- [ ] **F5**: All 4 charts render without errors (ProgressLine, Accuracy, DeckPerformance, StageDistribution)
- [ ] **F6**: All 4 widgets display correct data (Streak, WordStatus, Retention, TimeStudied)
- [ ] **F7**: Activity feed shows last 10 review sessions
- [ ] **F8**: Activity feed items clickable (navigate to deck detail)
- [ ] **F9**: Empty states display when no data available
- [ ] **F10**: Error state displays with retry button if fetch fails

### Visual & UX Requirements

- [ ] **U1**: Loading skeleton displays during initial fetch (< 500ms)
- [ ] **U2**: Date range buttons have active state highlighting
- [ ] **U3**: Charts have titles, descriptions, and proper spacing
- [ ] **U4**: Color palette consistent with Style Guide (#667eea, #10b981, #f59e0b)
- [ ] **U5**: Typography follows Style Guide (headings 18-28px, body 14-16px)
- [ ] **U6**: Icons from Lucide React library, sized consistently (h-5 w-5 for headers)
- [ ] **U7**: Separators between major sections for visual hierarchy
- [ ] **U8**: Empty states have helpful icon and message ("Start reviewing to see analytics")

### Responsive Design Requirements

- [ ] **R1**: Mobile (375px): All sections stack vertically, charts readable
- [ ] **R2**: Mobile: Metrics grid 2 columns, widgets grid 2 columns
- [ ] **R3**: Tablet (768px): Metrics grid 3 columns, charts 1 column, widgets 2 columns
- [ ] **R4**: Desktop (1024px+): Metrics grid 5 columns, charts 2 columns, widgets 4 columns
- [ ] **R5**: No horizontal scroll at any viewport width
- [ ] **R6**: Touch targets â‰¥ 44px on mobile (buttons, cards)
- [ ] **R7**: Charts scale proportionally with container (responsive)

### Technical Requirements

- [ ] **T1**: TypeScript compiles with 0 errors
- [ ] **T2**: Build succeeds with no warnings
- [ ] **T3**: No console errors during runtime
- [ ] **T4**: analyticsStore integrated correctly (useEffect, selectors)
- [ ] **T5**: Date range changes trigger store action (setDateRange)
- [ ] **T6**: Navigation works (useNavigate for activity feed, review button)
- [ ] **T7**: All imports resolve correctly
- [ ] **T8**: Component follows existing code patterns (hooks, JSX structure)

### Performance Requirements

- [ ] **P1**: Dashboard loads in < 2 seconds with 30 days of data
- [ ] **P2**: Date range filter updates in < 500ms
- [ ] **P3**: No layout shift after data loads (skeleton same size as content)
- [ ] **P4**: Charts render without lag (< 100ms)

---

## Testing Plan

### Manual Testing Scenarios

**Test 1: New User (No Data)**
- Expected: Empty states display on all charts/widgets
- Expected: Helpful messages guide user to start reviewing
- Expected: No broken components or errors

**Test 2: Active User (With Data)**
- Expected: All charts populate with real data
- Expected: Metrics show accurate counts
- Expected: Activity feed shows recent sessions

**Test 3: Date Range Filtering**
- Steps:
  1. Load dashboard (default: Last 30 Days)
  2. Click "Last 7 Days"
  3. Verify all charts update
  4. Click "All Time"
  5. Verify metrics recalculate
- Expected: All components update synchronously

**Test 4: Responsive Behavior**
- Steps:
  1. Open dashboard on desktop (1440px)
  2. Resize to tablet (768px)
  3. Resize to mobile (375px)
  4. Check all breakpoints
- Expected: Grids collapse correctly, no horizontal scroll

**Test 5: Loading State**
- Steps:
  1. Throttle network to Slow 3G (DevTools)
  2. Reload dashboard
  3. Observe loading skeleton
- Expected: Skeleton displays, transitions smoothly to content

**Test 6: Error Handling**
- Steps:
  1. Go offline (disconnect network)
  2. Reload dashboard
  3. Click retry button
- Expected: Error alert displays, retry works when back online

### Browser Testing

- [ ] Chrome (latest)
- [ ] Firefox (latest)
- [ ] Safari (latest)
- [ ] Mobile Safari (iOS)
- [ ] Chrome Mobile (Android)

---

## Documentation Updates Needed

### 1. Components-Reference.md

**Section to Add**: "Dashboard Page Integration Pattern"

**Content**:
- How to integrate analyticsStore in page components
- Pattern for loading states with Skeleton
- Pattern for error states with Alert
- Example of date range filtering implementation
- Responsive grid patterns used

**Estimated Length**: +50 lines

**Location**: Add after "Analytics Components" section

---

### 2. Style-Guide.md

**Section to Update**: "Layout Patterns"

**Content to Add**:
- Dashboard responsive grid patterns
- Spacing between major sections (Separator usage)
- Card header patterns (title + description + icon)
- Empty state patterns (icon + message)

**Estimated Length**: +30 lines

**Location**: Add to "Spacing & Layout" section

---

## Time Estimates

| Step | Description | Time (min) | Cumulative |
|------|-------------|------------|------------|
| 1 | Backup and setup | 2 | 2 |
| 2 | Update imports | 5 | 7 |
| 3 | Remove mock data, setup state | 3 | 10 |
| 4 | Create date range filter | 8 | 18 |
| 5 | Replace placeholder metrics | 10 | 28 |
| 6 | Add charts section | 12 | 40 |
| 7 | Add widgets section | 8 | 48 |
| 8 | Add activity feed | 6 | 54 |
| 9 | Add loading/error states | 8 | 62 |
| 10 | Remove test section | 2 | 64 |
| 11 | Responsive verification | 8 | 72 |
| 12 | Final testing | 8 | 80 |
| **TOTAL** | | **80 min** | |

**Budget**: 60 minutes allocated
**Estimate**: 80 minutes (20 minutes over)
**Recommendation**: Prioritize Steps 1-9 (54 min), defer Step 11-12 to Task 06.08 (Testing) if needed

---

## Potential Challenges and Mitigations

### Challenge 1: Chart Components Not Rendering

**Symptoms**: Charts show blank or error messages

**Possible Causes**:
- Chart components expect different data structure than provided
- analyticsStore returning null/undefined data
- Import paths incorrect

**Mitigation**:
1. Check chart component props match analyticsStore data shape
2. Add null checks before passing data to charts
3. Verify imports resolve (check components/charts/index.ts)
4. Test with mock data first before connecting to store

**Fallback**: Use empty state placeholders if charts fail, debug in 06.08

---

### Challenge 2: Date Range Filter Not Updating Charts

**Symptoms**: Clicking date range buttons doesn't update charts

**Possible Causes**:
- setDateRange not triggering store action
- Charts not subscribed to store updates
- React re-render not triggered

**Mitigation**:
1. Verify setDateRange calls store.setDateRange()
2. Use selector hooks (selectDashboardData) not direct store access
3. Check useEffect dependencies include dateRange
4. Add console.log to verify store state changes

**Debugging**:
```typescript
// Add temporary logging
useEffect(() => {
  console.log('Date range changed:', dateRange);
  console.log('Dashboard data:', dashboardData);
}, [dateRange, dashboardData]);
```

---

### Challenge 3: Loading State Flickers Too Fast

**Symptoms**: Loading skeleton appears and disappears too quickly (janky UX)

**Possible Causes**:
- Data cached, loads instantly
- Need minimum display time for skeleton

**Mitigation**:
- Acceptable behavior - cached data is good UX
- Only shows skeleton on first load
- If needed, add minimum 300ms delay (but not recommended for MVP)

**Accept As-Is**: Fast loading is a feature, not a bug

---

### Challenge 4: Responsive Layout Breaks on Specific Breakpoint

**Symptoms**: Charts overlap or overflow at certain viewport widths

**Possible Causes**:
- Tailwind breakpoints not matching chart responsive logic
- Fixed width containers conflicting with grid
- Chart library has min-width requirements

**Mitigation**:
1. Use Tailwind's responsive prefixes (md:, lg:) consistently
2. Ensure all containers use relative widths (not fixed px)
3. Test Recharts ResponsiveContainer wraps all charts
4. Add overflow-hidden to parent containers if needed

**Fallback**: Acceptable for charts to have min-width of 300px, force vertical stack on very small screens

---

### Challenge 5: TypeScript Errors with Store Types

**Symptoms**: Type errors when accessing dashboardData properties

**Possible Causes**:
- AnalyticsDashboardData type not matching actual data
- Null/undefined not handled with optional chaining
- Type imports missing

**Mitigation**:
1. Use optional chaining: `dashboardData?.summary.totalCardsReviewed`
2. Add null checks before accessing nested properties
3. Import types: `import type { AnalyticsDashboardData } from '@/types/analytics';`
4. Use non-null assertion only if certain data exists: `dashboardData!`

**Best Practice**: Always use optional chaining for store-derived data

---

## Rollback Plan

If implementation encounters blocking issues:

**Immediate Rollback**:
```bash
cd /Users/samosipov/Downloads/learn-greek-easy/learn-greek-easy-frontend
cp src/pages/Dashboard.backup.tsx src/pages/Dashboard.tsx
```

**Verify Rollback**:
```bash
npm run dev
# Check dashboard works with original mock data
```

**Report Issues**: Document blocking issue in Bug-Tracker.md, proceed to Task 06.08 for debugging

---

## Code Snippets Reference

### Complete Dashboard Component Structure (Skeleton)

```typescript
import React, { useEffect } from 'react';
import { useNavigate } from 'react-router-dom';
// ... all imports

export const Dashboard: React.FC = () => {
  const navigate = useNavigate();
  const { user } = useAuthStore();
  const dashboardData = useAnalyticsStore(selectDashboardData);
  const isLoading = useAnalyticsStore(selectIsLoading);
  const error = useAnalyticsStore(selectError);
  const dateRange = useAnalyticsStore(selectDateRange);
  const { loadAnalytics, setDateRange } = useAnalyticsStore();

  useEffect(() => {
    if (user?.id) {
      loadAnalytics(user.id);
    }
  }, [user?.id, loadAnalytics]);

  const handleDateRangeChange = (newRange: DateRangeType) => {
    setDateRange(newRange);
  };

  const dateRangeOptions: DateRangeType[] = ['last7', 'last30', 'alltime'];

  return (
    <div className="space-y-6 pb-8">
      {/* Loading State */}
      {isLoading && !dashboardData && (
        <div>{/* Skeleton components */}</div>
      )}

      {/* Error State */}
      {error && !isLoading && (
        <Alert variant="destructive">{/* Error message */}</Alert>
      )}

      {/* Main Content */}
      {!isLoading && dashboardData && (
        <>
          {/* Welcome Section */}
          <WelcomeSection {...} />

          {/* Date Range Filter */}
          <div className="flex items-center justify-between">
            {/* Filter buttons */}
          </div>

          {/* Metrics Grid */}
          <section>
            <h2>Your Progress</h2>
            <div className="grid grid-cols-2 gap-4 md:grid-cols-3 lg:grid-cols-5">
              {/* 5 MetricCards */}
            </div>
          </section>

          <Separator />

          {/* Charts Section */}
          <section>
            <h2>Progress Analytics</h2>
            <div className="grid grid-cols-1 gap-6 lg:grid-cols-2">
              {/* 4 Chart Cards */}
            </div>
          </section>

          <Separator />

          {/* Widgets Section */}
          <section>
            <h2>Key Metrics</h2>
            <div className="grid grid-cols-2 gap-4 md:grid-cols-4">
              {/* 4 Widgets */}
            </div>
          </section>

          <Separator />

          {/* Activity Feed */}
          <section>
            <h2>Recent Activity</h2>
            <ActivityFeed activities={dashboardData.recentActivity} />
          </section>
        </>
      )}
    </div>
  );
};
```

---

## Post-Implementation Checklist

After completing all steps, verify:

**Code Quality**:
- [ ] All imports at top, organized by category
- [ ] No unused imports or variables
- [ ] Consistent code formatting (Prettier)
- [ ] No hardcoded values (use constants or props)
- [ ] Helper functions extracted (formatTimeStudied, getDateRangeLabel)

**Functionality**:
- [ ] Dashboard loads without errors
- [ ] All sections render correctly
- [ ] Date range filter functional
- [ ] Navigation works from all clickable elements

**Responsive Design**:
- [ ] Tested at 375px, 768px, 1024px, 1440px
- [ ] No horizontal scroll
- [ ] Touch targets adequate size
- [ ] Charts readable at all sizes

**Performance**:
- [ ] No console warnings
- [ ] Load time < 2 seconds
- [ ] Date filter updates < 500ms
- [ ] No memory leaks (check DevTools Performance)

**Documentation**:
- [ ] Added comments for complex logic
- [ ] Updated Components-Reference.md (if time permits)
- [ ] Updated Style-Guide.md (if time permits)
- [ ] Noted any deferred work for 06.08

---

## Next Steps (After 06.07 Complete)

1. **Task 06.08**: Testing, Polish, Documentation
   - Comprehensive testing of all analytics features
   - Capture screenshots with Playwright
   - Update all documentation
   - Final bug fixes

2. **Integration Points**:
   - Verify review session completion updates analytics
   - Test deck progress changes reflect in dashboard
   - Ensure logout clears analytics state

3. **Future Enhancements** (Post-MVP):
   - Custom date range picker
   - Export analytics to PDF/CSV
   - Advanced filtering (by deck, by difficulty)
   - Heatmap calendar visualization

---

## Planner Notes

**Rationale for Approach**:
- **Incremental Integration**: Build dashboard section by section to isolate issues
- **Loading States First**: Ensures smooth UX even if data fetch is slow
- **Empty States**: Critical for new users, prevents broken UI
- **Responsive-First**: Tailwind's mobile-first approach, test at each breakpoint

**Assumptions**:
- All analytics components (06.01-06.06) are fully functional and tested
- analyticsStore working correctly with mock data
- Chart components accept data in expected format
- User is authenticated (has valid userId)

**Dependencies Verified**:
- âœ… Task 06.01: Analytics data types defined
- âœ… Task 06.02: analyticsStore implemented
- âœ… Task 06.03: Recharts installed and configured
- âœ… Task 06.04: Chart components built (4 charts)
- âœ… Task 06.05: Widget components built (4 widgets)
- âœ… Task 06.06: Activity feed component built

**Risk Assessment**:
- **Low Risk**: Most components pre-built and tested
- **Medium Risk**: Integration complexity (many moving parts)
- **Mitigation**: Incremental approach, thorough testing at each step

**Time Management**:
- Estimated 80 minutes vs 60 minute budget
- Critical path: Steps 1-9 (54 minutes) - complete these first
- Nice-to-have: Steps 11-12 can defer to Task 06.08 if needed
- Buffer: 15 minutes built into time estimates for debugging

**Success Definition**:
- Dashboard displays real analytics data (not mock)
- All sections render without errors
- Date range filter functional
- Responsive layout works
- Ready for comprehensive testing in 06.08

---

**End of Implementation Plan**
