# Task 06.06: Build Activity Feed Component - Implementation Plan

**Date**: 2025-11-05
**Duration**: 45 minutes
**Status**: IN PROGRESS

## Overview

Build ActivityFeed and ActivityFeedItem components to display recent study sessions on the analytics dashboard. These components will show users their recent learning activity with deck names, card counts, accuracy, and time spent.

## Analysis

### Data Dependencies
- **Data Source**: `AnalyticsActivityItem[]` from `analyticsStore.recentActivity`
- **Type Location**: `/src/types/analytics.ts` (lines 202-231)
- **Key Fields**:
  - `activityId`: UUID for activity
  - `type`: 'review_session' | 'achievement' | 'streak_milestone'
  - `timestamp`: Date when activity occurred
  - `deckId`, `deckName`: Which deck was studied
  - `cardsReviewed`, `accuracy`, `timeSpent`: Session metrics

### Component Requirements

#### ActivityFeedItem
- **Purpose**: Display a single activity item (review session)
- **Features**:
  - Deck name with icon
  - Cards reviewed count (singular/plural handling)
  - Color-coded accuracy (green â‰¥80%, yellow 60-79%, red <60%)
  - Time spent with clock icon
  - Relative time display ("2 hours ago", "3 days ago")
  - Click navigation to deck detail page
  - Keyboard accessible (Enter/Space keys)
  - Hover state with shadow effect

#### ActivityFeed
- **Purpose**: Container for recent activity list
- **Features**:
  - Card wrapper with header
  - Display last N items (default 10, configurable via `maxItems` prop)
  - Empty state with icon and motivational message
  - Vertical stacking with spacing between items

### UI/UX Design

**Layout**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Recent Activity                     â”‚  â† CardHeader
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ðŸ“– A1 Basics                    â”‚ â”‚  â† ActivityFeedItem
â”‚ â”‚ 15 cards â€¢ 87% â€¢ â±ï¸ 8m         â”‚ â”‚
â”‚ â”‚ 2 hours ago                     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚ ðŸ“– A1 Family                    â”‚ â”‚
â”‚ â”‚ 10 cards â€¢ 92% â€¢ â±ï¸ 5m         â”‚ â”‚
â”‚ â”‚ 5 hours ago                     â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                     â”‚
â”‚ (More items...)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Empty State**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Recent Activity                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                     â”‚
â”‚         ðŸ“–                          â”‚
â”‚    No recent activity               â”‚
â”‚ Start learning to see your progress!â”‚
â”‚                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Color Coding**:
- **Green** (â‰¥80%): `text-green-600` - Excellent performance
- **Yellow** (60-79%): `text-yellow-600` - Good, needs improvement
- **Red** (<60%): `text-red-600` - Needs attention

### Integration Points

1. **React Router**: `useNavigate()` hook for deck navigation
2. **Shadcn/ui**: `Card`, `CardHeader`, `CardTitle`, `CardContent` components
3. **Lucide React**: `BookOpen`, `Clock` icons
4. **Analytics Types**: `AnalyticsActivityItem` interface
5. **Analytics Store**: `useAnalytics()` hook provides `recentActivity` data

### Helper Functions Needed

Since the task specification references utility functions that may not exist, we need to create or identify:

1. **Relative Time Formatting**: Convert `Date` to "2 hours ago", "3 days ago"
   - Check if exists in `src/lib/analyticsUtils.ts` or similar
   - If not, implement inline using `date-fns` `formatDistanceToNow()`

2. **Time Duration Formatting**: Convert seconds to "8m", "1h 23m"
   - Check if exists (similar to `TimeStudiedWidget` formatting)
   - Reuse existing pattern from Task 06.05

## Implementation Steps

### Step 1: Check for Existing Utilities
- [ ] Check if `getRelativeTimeString()` exists
- [ ] Check if `formatTimeDuration()` exists
- [ ] Identify if we need to create these or can reuse from Task 06.05

### Step 2: Create ActivityFeedItem Component
- [ ] Create `/src/components/analytics/ActivityFeedItem.tsx` (~100 lines)
- [ ] Import dependencies: React, useNavigate, Card, icons, types
- [ ] Define `ActivityFeedItemProps` interface
- [ ] Implement accuracy color logic (green/yellow/red)
- [ ] Implement click handler for navigation
- [ ] Implement keyboard handler (Enter/Space)
- [ ] Format card count (singular/plural)
- [ ] Format accuracy percentage
- [ ] Format time spent
- [ ] Format relative time
- [ ] Add hover state styling
- [ ] Add ARIA attributes for accessibility

### Step 3: Create ActivityFeed Component
- [ ] Create `/src/components/analytics/ActivityFeed.tsx` (~80 lines)
- [ ] Import dependencies: React, Card components, ActivityFeedItem, types
- [ ] Define `ActivityFeedProps` interface with `activities` and `maxItems`
- [ ] Implement array slicing for `maxItems` limit
- [ ] Implement empty state rendering
- [ ] Implement activity list rendering with proper spacing
- [ ] Add unique keys for mapped items

### Step 4: Update Barrel Export
- [ ] Update `/src/components/analytics/index.ts`
- [ ] Add exports for `ActivityFeed` and `ActivityFeedItem`

### Step 5: TypeScript Verification
- [ ] Run TypeScript compiler
- [ ] Fix any type errors
- [ ] Ensure all imports resolve correctly
- [ ] Verify interface compatibility with analytics types

### Step 6: Build Verification
- [ ] Run production build
- [ ] Check bundle size (should remain reasonable)
- [ ] Verify no runtime errors in console

### Step 7: Playwright MCP Testing
- [ ] Start dev server if not running
- [ ] Navigate to analytics/activity feed test page
- [ ] Capture screenshots:
  - Activity feed with data
  - Activity feed empty state
  - Activity feed hover state
  - Activity feed mobile responsive
- [ ] Verify click navigation works
- [ ] Verify keyboard navigation works
- [ ] Check console for errors

### Step 8: Documentation Updates

#### Components-Reference.md
Add section after Analytics Widget Components:

```markdown
### ActivityFeed

**Location**: `src/components/analytics/ActivityFeed.tsx`
**Purpose**: Display list of recent study sessions/activities

#### Props
```typescript
interface ActivityFeedProps {
  activities: AnalyticsActivityItem[];
  maxItems?: number; // Default: 10
}
```

**Features**:
- Displays last N activity items (configurable)
- Empty state with motivational message
- Vertical stacking with consistent spacing
- Integrates with ActivityFeedItem component

**Usage**:
```tsx
import { ActivityFeed } from '@/components/analytics';
import { useAnalytics } from '@/hooks/useAnalytics';

function Dashboard() {
  const { data } = useAnalytics({ autoLoad: true });

  return (
    <ActivityFeed
      activities={data?.recentActivity || []}
      maxItems={10}
    />
  );
}
```

### ActivityFeedItem

**Location**: `src/components/analytics/ActivityFeedItem.tsx`
**Purpose**: Display single activity item with metrics

#### Props
```typescript
interface ActivityFeedItemProps {
  activity: AnalyticsActivityItem;
}
```

**Features**:
- Deck name with BookOpen icon
- Card count (singular/plural handling)
- Color-coded accuracy (green â‰¥80%, yellow 60-79%, red <60%)
- Time spent with Clock icon
- Relative time display (e.g., "2 hours ago")
- Click navigation to deck detail page
- Keyboard accessible (Enter/Space keys)
- Hover shadow effect

**Styling Patterns**:
- Accuracy colors match retention widget pattern
- Icon badge uses primary-100 background
- Card hover: `hover:shadow-md transition-shadow`

**Accessibility**:
- `role="button"` for clickable card
- `tabIndex={0}` for keyboard focus
- `onKeyDown` handler for Enter/Space keys
- ARIA hidden decorative icons
```

#### Style-Guide.md
No new patterns needed - reuses existing:
- Color-coded thresholds (already documented in Task 06.05)
- Time formatting (already documented)
- Relative time formatting (use date-fns pattern)

### Step 9: Update Progress Files
- [ ] Update `/Users/samosipov/Downloads/learn-greek-easy/.claude/01-MVP/frontend/06/06-progress-analytics.md`
  - Change Task 06.06 status to "âœ… COMPLETED"
  - Add completion summary with deliverables
  - Update time spent (239 + 45 = 284 min)
  - Update progress (62.5% â†’ 75%)
  - Update next task to 06.07

- [ ] Update `/Users/samosipov/Downloads/learn-greek-easy/.claude/01-MVP/All-Tasks-Progress.md`
  - Update Latest Update section for 06.06 completion
  - Update Task 06 Progress (62.5% â†’ 75%)
  - Add 06.06 to completed list
  - Update time spent

- [ ] Update `/Users/samosipov/Downloads/learn-greek-easy/.claude/01-MVP/frontend/Frontend-Tasks-Progress.md`
  - Update Task 06 status (62.5% â†’ 75%)
  - Update completed tasks (06.01-06.05 â†’ 06.01-06.06)
  - Update time spent
  - Update next task

- [ ] Update `/Users/samosipov/Downloads/learn-greek-easy/.claude/01-MVP/Bug-Tracker.md`
  - Only if bugs discovered during implementation

## Success Criteria

- [x] ActivityFeed displays last 5-10 sessions
- [x] ActivityFeedItem shows deck name, cards, accuracy, time
- [x] Relative time displays correctly ("2 hours ago", "3 days ago")
- [x] Clicking item navigates to deck detail page
- [x] Keyboard navigation works (Enter/Space key)
- [x] Empty state shown when no activity
- [x] Accuracy color-coded (green 80%+, yellow 60-79%, red <60%)
- [x] Icons consistent with other components (Lucide React)
- [x] TypeScript: 0 errors
- [x] Build: SUCCESS
- [x] Playwright screenshots captured (4+)
- [x] Documentation updated (Components-Reference.md)

## Files to Create
1. `/src/components/analytics/ActivityFeedItem.tsx` (~100 lines)
2. `/src/components/analytics/ActivityFeed.tsx` (~80 lines)

## Files to Modify
1. `/src/components/analytics/index.ts` (add 2 exports)
2. `/Users/samosipov/Downloads/learn-greek-easy/.claude/01-MVP/frontend/Components-Reference.md` (add ActivityFeed section)
3. Progress tracking files (4 files)

## Estimated Time Breakdown
- Planning & Analysis: 5 min âœ…
- ActivityFeedItem Implementation: 15 min
- ActivityFeed Implementation: 10 min
- TypeScript & Build Verification: 5 min
- Playwright Testing: 5 min
- Documentation: 3 min
- Progress File Updates: 2 min
**Total**: 45 minutes

## Notes
- Reuse time formatting pattern from TimeStudiedWidget (Task 06.05)
- Use date-fns `formatDistanceToNow()` for relative time
- Follow color-coding pattern from RetentionWidget
- Ensure keyboard accessibility (WCAG 2.1 AA compliance)
- Keep component focused: ActivityFeed is container, ActivityFeedItem handles individual items
