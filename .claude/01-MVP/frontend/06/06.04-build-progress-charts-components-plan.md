# Task 06.04: Build Progress Charts Components - Implementation Plan

**Document Version**: 1.1
**Date**: November 4, 2025
**Status**: ✅ COMPLETE
**Estimated Duration**: 75 minutes
**Actual Duration**: ~75 minutes
**Completion Date**: November 4, 2025
**Grade**: A (45/47 criteria met - 95.7%)

## Table of Contents
1. [Overview](#overview)
2. [Dependencies & Prerequisites](#dependencies--prerequisites)
3. [Architecture Analysis](#architecture-analysis)
4. [Chart Specifications](#chart-specifications)
5. [Implementation Steps](#implementation-steps)
6. [Complete Code Templates](#complete-code-templates)
7. [Success Criteria](#success-criteria)
8. [Data Formatting & Utilities](#data-formatting--utilities)
9. [Responsive Design Strategy](#responsive-design-strategy)
10. [Testing & Verification](#testing--verification)
11. [Timeline Breakdown](#timeline-breakdown)
12. [Files Summary](#files-summary)
13. [Integration Examples](#integration-examples)
14. [Known Constraints & Decisions](#known-constraints--decisions)
15. [Next Steps](#next-steps)

---

## Overview

### Task Description
Build 4 Recharts visualization components that display analytics data from the Learn Greek Easy dashboard. These components consume data from hooks created in Task 06.02 and use infrastructure (wrapper components, color schemes) prepared in Task 06.03.

### Business Goals
- Provide clear visual representation of learning progress trends
- Enable users to analyze deck-level performance comparisons
- Display learning stage distributions and accuracy trends
- Support informed decisions about study focus areas

### Technical Goals
- Create reusable, responsive chart components following React best practices
- Maintain TypeScript strict mode compliance throughout
- Implement consistent error handling and empty state management
- Ensure responsive behavior across mobile (375px), tablet (768px), and desktop (1024px+)

### Duration Estimate
**75 minutes total** broken into:
- ProgressLineChart: 20 minutes
- AccuracyAreaChart: 15 minutes
- DeckPerformanceChart: 20 minutes
- StageDistributionChart: 15 minutes
- Integration & Verification: 5 minutes

### Deliverables
1. ProgressLineChart.tsx - Line chart showing word status progression
2. AccuracyAreaChart.tsx - Area chart showing accuracy trends
3. DeckPerformanceChart.tsx - Horizontal bar chart showing deck performance
4. StageDistributionChart.tsx - Pie chart showing word status breakdown
5. Updated charts/index.ts with all exports
6. Zero TypeScript errors
7. Successful build completion

---

## Dependencies & Prerequisites

### Task Dependencies (All Must Be Completed)
- **Task 06.01**: All analytics types defined (ProgressDataPoint, DeckPerformanceStats, WordStatusBreakdown)
- **Task 06.02**: All data hooks implemented (useProgressData, useDeckPerformance, useAnalytics)
- **Task 06.03**: Recharts installed, chartConfig.ts ready, wrapper components (ChartContainer, ChartTooltip, ChartLegend) implemented

### External Dependencies
- **recharts**: ^3.3.0 - Already installed
- **react**: ^19.1.1
- **typescript**: ~5.9.3
- **date-fns**: For date formatting (already available in project context)

### Available Infrastructure
```typescript
// From /src/lib/chartConfig.ts
- chartColors: 8-color palette + semantic colors
- colorSchemes: binary, tertiary, spectrum, performance, progression
- getResponsiveHeight(width): function for responsive sizing
- chartConfig.margin, chartConfig.grid, chartConfig.axis, chartConfig.tooltip, chartConfig.legend
```

### Available Wrapper Components
```typescript
// From /src/components/charts/
- ChartContainer: Responsive container with loading/empty states
- ChartTooltip: Custom tooltip matching theme
- ChartLegend: Configured legend component
```

### Hooks Available
```typescript
// From hooks created in Task 06.02
- useProgressData(): returns { progressData, loading, error }
- useDeckPerformance(): returns { deckStats, loading, error }
- useAnalytics(autoLoad?): returns { data, loading, error, dateRange, refresh, setDateRange }
```

---

## Architecture Analysis

### Data Flow Architecture

```
useAnalyticsStore (state management)
    ↓
    ├→ useProgressData() ────→ ProgressLineChart (3 series)
    │                       ├→ AccuracyAreaChart (gradient fill)
    │
    ├→ useDeckPerformance() ─→ DeckPerformanceChart (8 colors)
    │
    └→ useAnalytics()
        └→ data.wordStatus ──→ StageDistributionChart (pie)
```

### Component Structure
Each chart component follows this pattern:
1. **Hook invocation**: Call appropriate hook to get data
2. **State management**: Extract loading, error, and data states
3. **Conditional rendering**: Handle loading → error → empty → success states
4. **Chart rendering**: Use Recharts components with ChartContainer wrapper
5. **Responsive design**: Use getResponsiveHeight and responsive attributes

### Error Handling Strategy
- **Loading state**: Show ChartContainer with loading=true (displays Skeleton)
- **Error state**: Show error message with graceful fallback
- **Empty state**: Show ChartContainer with noData=true (displays "No data available")
- **Data validation**: Each chart validates data before rendering

### Type Safety Approach
- All components use TypeScript interfaces with strict mode
- Hook return types properly typed
- Data properties accessed with type guards
- No `any` types used

---

## Chart Specifications

### Chart 1: ProgressLineChart

**Purpose & Visualization**
Displays three word status categories over the last 30 days as separate trend lines.
- Shows: wordsNew, wordsLearning, wordsMastered (or cardsNew, cardsLearning, cardsMastered)
- X-axis: Dates (formatted as "MMM dd")
- Y-axis: Card count (numbers 0-max)
- Time range: Last 30 days (from data source)

**Data Source & Structure**
```typescript
Hook: useProgressData()
Data type: ProgressDataPoint[]
Required fields:
  - dateString: string (ISO format YYYY-MM-DD for X-axis)
  - cardsNew: number (cyan line)
  - cardsLearning: number (blue line)
  - cardsMastered: number (green line)
```

**Recharts Components**
```
LineChart (responsive)
  ├─ CartesianGrid (dashed, gray200)
  ├─ XAxis (dataKey: "dateString", tick formatter: date format)
  ├─ YAxis (formatter: number format)
  ├─ Tooltip (custom: ChartTooltip)
  ├─ Legend (at bottom)
  ├─ Line 1: dataKey="cardsNew", stroke=cyan-500
  ├─ Line 2: dataKey="cardsLearning", stroke=blue-500
  └─ Line 3: dataKey="cardsMastered", stroke=green-500
```

**Color Scheme**
- Uses `colorSchemes.progression` (cyan, blue, green)
- Chart colors: chart6 (cyan), chart1 (blue), chart2 (green)

**Responsive Behavior**
- Mobile (<768px): Reduce XAxis ticks, smaller fonts (10px)
- Tablet (768-1023px): Standard ticks, normal fonts (12px)
- Desktop (1024px+): All ticks, full fonts (14px)

**Empty State**
Show "No data available" when progressData.length === 0

**Loading State**
Show skeleton via ChartContainer loading prop

**Tooltip Customization**
```
Format:
  Label: "Nov 04"
  cardsNew: "125"
  cardsLearning: "84"
  cardsMastered: "342"
```

**Legend Configuration**
- Position: bottom
- Icon type: circle
- Labels: "New Cards", "Learning Cards", "Mastered Cards"

---

### Chart 2: AccuracyAreaChart

**Purpose & Visualization**
Displays accuracy percentage trend over time with gradient fill.
- Shows: accuracy metric (0-100%) as area chart
- X-axis: Dates (formatted as "MMM dd")
- Y-axis: Percentage (0-100%)
- Color: Blue with gradient fill
- Time range: Last 30 days

**Data Source & Structure**
```typescript
Hook: useProgressData()
Data type: ProgressDataPoint[]
Required fields:
  - dateString: string (ISO format YYYY-MM-DD)
  - accuracy: number (0-100, percentage)
```

**Recharts Components**
```
AreaChart (responsive)
  ├─ defs (gradient definition)
  │   └─ linearGradient (id="accuracyGradient")
  │       ├─ stop (offset: 0%, color: blue-500, opacity: 0.3)
  │       └─ stop (offset: 100%, color: blue-500, opacity: 0.05)
  ├─ CartesianGrid (dashed)
  ├─ XAxis (dataKey: "dateString", tickFormatter)
  ├─ YAxis (domain: [0, 100], tickFormatter: "%")
  ├─ Tooltip (custom: ChartTooltip with % formatter)
  └─ Area (dataKey: "accuracy", fill: url(#accuracyGradient), stroke: blue)
```

**Color Scheme**
- Uses `chartColors.chart1` (blue-500: #3b82f6)
- Gradient: opaque blue to transparent blue

**Responsive Behavior**
- Mobile: Height 250px, tick count 5
- Tablet: Height 300px, tick count 8
- Desktop: Height 350px, all ticks visible

**Empty State**
Show "No accuracy data available" when no data

**Loading State**
Show skeleton via ChartContainer

**Tooltip Customization**
```
Format:
  Label: "Nov 04"
  Accuracy: "87%"
```

**Legend Configuration**
- Not required (single series)
- Show single label "Accuracy" if legend shown

---

### Chart 3: DeckPerformanceChart

**Purpose & Visualization**
Compares mastery/completion rates across all decks as horizontal bars.
- Shows: mastery percentage (cardsMastered / cardsInDeck) × 100 for each deck
- Format: Horizontal bars (Y-axis: deck names, X-axis: percentage 0-100%)
- Colors: Spectrum scheme (8 colors for up to 8 decks)
- Allows comparison of which decks need focus

**Data Source & Structure**
```typescript
Hook: useDeckPerformance()
Data type: DeckPerformanceStats[]
Required fields:
  - deckId: string (unique identifier)
  - deckName: string (display name, e.g., "A1 Basics")
  - mastery: number (percentage 0-100)
  - cardsMastered: number (for tooltip)
  - cardsInDeck: number (for tooltip)
  - accuracy: number (for tooltip)
```

**Recharts Components**
```
BarChart (responsive, layout: "vertical")
  ├─ CartesianGrid (dashed)
  ├─ XAxis (type: "number", domain: [0, 100], tickFormatter: "%")
  ├─ YAxis (type: "category", dataKey: "deckName", width: 120)
  ├─ Tooltip (custom: ChartTooltip)
  └─ Bar (dataKey: "mastery", fill: assigned color, shape: RadiusBox)
```

**Color Scheme**
- Uses `colorSchemes.spectrum` (8 colors)
- Color assignment: color[index % 8] for each deck
- Implementation: `Cell` component for per-bar coloring

**Responsive Behavior**
- Mobile: YAxis width 100px, small font (10px)
- Tablet: YAxis width 120px, normal font (12px)
- Desktop: YAxis width 140px, larger font (13px)

**Empty State**
Show "No deck data available" when deckStats.length === 0

**Loading State**
Show skeleton via ChartContainer

**Tooltip Customization**
```
Format:
  Deck: "A1 Basics"
  Mastery: "87%"
  (Additional in details):
    "Cards: 342 / 400"
    "Accuracy: 88%"
```

**Legend Configuration**
- Not required (no series legend needed)
- Can show single legend entry "Deck Mastery %" if desired

---

### Chart 4: StageDistributionChart

**Purpose & Visualization**
Shows pie chart of word status breakdown (new/learning/review/mastered/relearning).
- Shows: Distribution across 5 learning stages
- Labels: Show percentages on chart
- Colors: Progression scheme (cyan → blue → green) extended with additional colors
- Center label: Show total card count

**Data Source & Structure**
```typescript
Hook: useAnalytics() or direct dashboardData?.wordStatus access
Data type: WordStatusBreakdown
Required fields:
  - new: number
  - learning: number
  - review: number
  - mastered: number
  - relearning: number
  - total: number
  - newPercent, learningPercent, reviewPercent, masteredPercent, relearningPercent
```

**Recharts Components**
```
PieChart (responsive)
  ├─ Pie (data: transformed from WordStatusBreakdown)
  │   ├─ Cell (per-slice, color from spectrum)
  │   ├─ Label (formatter: show percentage)
  │   └─ Center text: total count
  └─ Tooltip (custom: show name, count, percentage)
```

**Data Transformation**
WordStatusBreakdown needs transformation to Recharts format:
```typescript
const pieData = [
  { name: "New", value: wordStatus.new, percent: wordStatus.newPercent },
  { name: "Learning", value: wordStatus.learning, percent: wordStatus.learningPercent },
  { name: "Review", value: wordStatus.review, percent: wordStatus.reviewPercent },
  { name: "Mastered", value: wordStatus.mastered, percent: wordStatus.masteredPercent },
  { name: "Relearning", value: wordStatus.relearning, percent: wordStatus.relearningPercent },
]
```

**Color Scheme**
- Uses extended spectrum scheme (5 colors for 5 stages)
- Colors: cyan, blue, green, amber, red
- Order: new (cyan) → learning (blue) → review (green) → mastered (gold) → relearning (red)

**Responsive Behavior**
- Mobile: Outer radius 80, font 10px
- Tablet: Outer radius 100, font 11px
- Desktop: Outer radius 120, font 12px

**Empty State**
Show "No stage data available" when total === 0

**Loading State**
Show skeleton via ChartContainer

**Tooltip Customization**
```
Format:
  New: 45 cards (12%)
  Learning: 120 cards (32%)
  Review: 90 cards (24%)
  Mastered: 98 cards (26%)
  Relearning: 24 cards (6%)
```

**Legend Configuration**
- Position: bottom
- Show all 5 stages with icons and percentages
- Format: "New (12%)", "Learning (32%)", etc.

---

## Implementation Steps

### Step 1: Create ProgressLineChart Component (20 minutes)

**1.1 Create file** (1 min)
- File: `/src/components/charts/ProgressLineChart.tsx`
- Contains: Component function, TypeScript interfaces, export

**1.2 Implement component structure** (5 min)
- Import required modules: React, Recharts, hooks, config
- Define component props interface: `ProgressLineChartProps { height?: number; className?: string; }`
- Call `useProgressData()` hook to get data, loading, error states
- Implement conditional rendering for loading/error/empty/success

**1.3 Build chart structure** (10 min)
- Wrap in ChartContainer with title="Progress Over Time"
- Create ResponsiveContainer with aspect ratio
- Implement LineChart with three Line components
- Configure CartesianGrid, XAxis, YAxis
- Add custom Tooltip and Legend
- Apply color scheme (cyan, blue, green)
- Configure axis formatters (dates, numbers)

**1.4 Add responsive features** (2 min)
- Use getResponsiveHeight for responsive height
- Implement responsive tick counts based on viewport
- Adjust font sizes for mobile/tablet/desktop

**1.5 Testing**
- Verify with mock data: Should show 3 lines
- Check loading state: Should show skeleton
- Check empty state: Should show "No data available"
- Verify colors match: cyan, blue, green

---

### Step 2: Create AccuracyAreaChart Component (15 minutes)

**2.1 Create file** (1 min)
- File: `/src/components/charts/AccuracyAreaChart.tsx`
- Component for accuracy trend visualization

**2.2 Implement component structure** (4 min)
- Import modules: React, Recharts, hooks, config, defs for gradients
- Define props interface: `AccuracyAreaChartProps { height?: number; className?: string; }`
- Call `useProgressData()` hook
- Handle loading/error/empty states

**2.3 Build chart with gradient** (8 min)
- Create linearGradient definition in defs section
- Implement AreaChart with gradient-filled area
- Configure CartesianGrid, XAxis (date formatter), YAxis (percentage 0-100)
- Add custom Tooltip with percentage formatting
- Set area stroke to blue and fill to gradient

**2.4 Add responsive features** (2 min)
- Responsive height based on viewport
- Responsive font sizes and tick counts

**2.5 Testing**
- Verify gradient renders: Visual inspection
- Check Y-axis range: 0-100 with % symbols
- Verify tooltip formatting: Shows percentages
- Test empty state handling

---

### Step 3: Create DeckPerformanceChart Component (20 minutes)

**3.1 Create file** (1 min)
- File: `/src/components/charts/DeckPerformanceChart.tsx`
- Horizontal bar chart for deck comparison

**3.2 Implement component structure** (4 min)
- Import modules: React, Recharts, hooks, config
- Define props: `DeckPerformanceChartProps { height?: number; maxDecks?: number; }`
- Call `useDeckPerformance()` hook
- Sort decks by mastery descending (best first)
- Handle loading/error/empty states

**3.3 Build horizontal bar chart** (12 min)
- Implement BarChart with layout="vertical"
- Configure XAxis (type: "number", domain: [0, 100])
- Configure YAxis (type: "category", dataKey: "deckName")
- Implement Bar with Cell components for per-bar coloring
- Assign colors from spectrum scheme using index % 8
- Add custom Tooltip showing deck name, mastery %, cards, accuracy
- Configure CartesianGrid and styling

**3.4 Add responsive features** (2 min)
- Responsive YAxis width (100px mobile, 140px desktop)
- Responsive font sizes
- Responsive chart height

**3.5 Testing**
- Verify bar colors: Different color per deck
- Check data display: Shows all decks
- Verify tooltip: Shows detailed info
- Test sorting: Highest mastery first
- Test with 1-8 decks: Should display correctly

---

### Step 4: Create StageDistributionChart Component (15 minutes)

**4.1 Create file** (1 min)
- File: `/src/components/charts/StageDistributionChart.tsx`
- Pie chart for stage distribution

**4.2 Implement component structure** (4 min)
- Import modules: React, Recharts, hooks, config
- Define props: `StageDistributionChartProps { height?: number; className?: string; }`
- Call `useAnalytics()` hook to get dashboardData?.wordStatus
- Extract WordStatusBreakdown data
- Transform to Recharts format (array of {name, value, percent})
- Handle loading/error/empty states

**4.3 Build pie chart** (8 min)
- Create Pie component with responsive outer radius
- Implement Cell components for per-slice coloring (5 colors)
- Add labels showing percentages
- Implement center label showing total count
- Add custom Tooltip with name, count, percentage
- Configure legend at bottom
- Apply stage-specific colors (new→cyan, learning→blue, etc.)

**4.4 Add responsive features** (2 min)
- Responsive outer radius (80-120px)
- Responsive font sizes
- Responsive center label

**4.5 Testing**
- Verify all 5 slices render: new, learning, review, mastered, relearning
- Check colors: Different color per stage
- Verify percentages: Sum to 100%
- Check tooltip: Shows detailed breakdown
- Test empty state: When no cards

---

### Step 5: Integration & Verification (5 minutes)

**5.1 Update charts/index.ts** (1 min)
- Export all 4 new chart components
- Verify barrel export syntax

**5.2 TypeScript compilation** (2 min)
- Run `npm run type-check`
- Verify: 0 errors, 0 warnings
- Fix any type issues immediately

**5.3 Build verification** (1 min)
- Run `npm run build`
- Verify: BUILD SUCCESS

**5.4 Final checks** (1 min)
- Verify imports work from @/components/charts
- Verify no breaking changes to existing code
- Confirm all 4 components ready for integration page

---

## Complete Code Templates

### Template 1: ProgressLineChart.tsx

```typescript
// src/components/charts/ProgressLineChart.tsx

import React, { useMemo } from 'react';
import {
  LineChart,
  Line,
  XAxis,
  YAxis,
  CartesianGrid,
  Tooltip,
  Legend,
  ResponsiveContainer,
  TooltipProps,
} from 'recharts';
import { format } from 'date-fns';
import { useProgressData } from '@/hooks/useProgressData';
import { ChartContainer, ChartTooltip } from '@/components/charts';
import { chartColors, colorSchemes, getResponsiveHeight } from '@/lib/chartConfig';
import { ProgressDataPoint } from '@/types/analytics';

interface ProgressLineChartProps {
  height?: number;
  className?: string;
}

/**
 * LineChart visualization of word status progression over time
 * Shows three trends: New Cards, Learning Cards, Mastered Cards
 *
 * @example
 * ```tsx
 * <ProgressLineChart height={300} />
 * ```
 */
export const ProgressLineChart = React.forwardRef<HTMLDivElement, ProgressLineChartProps>(
  ({ height, className }, ref) => {
    const { progressData, loading, error } = useProgressData();

    // Responsive configuration based on viewport width
    const getResponsiveConfig = () => {
      if (typeof window === 'undefined') {
        return { tickCount: 5, fontSize: 12 };
      }
      const width = window.innerWidth;
      if (width < 768) return { tickCount: 4, fontSize: 10 };
      if (width < 1024) return { tickCount: 6, fontSize: 11 };
      return { tickCount: 8, fontSize: 12 };
    };

    const responsiveConfig = useMemo(() => getResponsiveConfig(), []);
    const chartHeight = height || getResponsiveHeight(typeof window !== 'undefined' ? window.innerWidth : 1024);

    // Format X-axis dates
    const formatXAxis = (dateString: string): string => {
      try {
        const date = new Date(dateString);
        return format(date, 'MMM dd');
      } catch {
        return dateString;
      }
    };

    // Custom tooltip for line chart
    const CustomTooltip = (props: TooltipProps<number, string>) => {
      const { active, payload, label } = props;
      if (!active || !payload || payload.length === 0) return null;

      return (
        <ChartTooltip
          active={active}
          payload={payload as any}
          label={label}
          labelFormatter={formatXAxis}
          formatter={(value) => `${Number(value).toLocaleString()}`}
        />
      );
    };

    // Handle error state
    if (error) {
      return (
        <ChartContainer
          ref={ref}
          className={className}
          title="Progress Over Time"
          description="Word status progression trend"
          noData
        >
          <div className="text-red-600">Error loading data: {error}</div>
        </ChartContainer>
      );
    }

    // Handle loading state
    if (loading) {
      return (
        <ChartContainer
          ref={ref}
          className={className}
          title="Progress Over Time"
          description="Word status progression trend"
          loading
          height={chartHeight}
        />
      );
    }

    // Handle empty state
    if (!progressData || progressData.length === 0) {
      return (
        <ChartContainer
          ref={ref}
          className={className}
          title="Progress Over Time"
          description="Word status progression trend"
          noData
          height={chartHeight}
        />
      );
    }

    return (
      <ChartContainer
        ref={ref}
        className={className}
        title="Progress Over Time"
        description="Word status progression trend"
        height={chartHeight}
      >
        <ResponsiveContainer width="100%" height={chartHeight}>
          <LineChart
            data={progressData}
            margin={{ top: 20, right: 30, left: 0, bottom: 5 }}
          >
            <CartesianGrid
              strokeDasharray="3 3"
              stroke={chartColors.gray200}
            />
            <XAxis
              dataKey="dateString"
              tick={{ fontSize: responsiveConfig.fontSize, fill: chartColors.gray600 }}
              tickCount={responsiveConfig.tickCount}
              tickFormatter={formatXAxis}
              stroke={chartColors.gray300}
            />
            <YAxis
              tick={{ fontSize: responsiveConfig.fontSize, fill: chartColors.gray600 }}
              stroke={chartColors.gray300}
              tickFormatter={(value) => `${value}`}
            />
            <Tooltip content={<CustomTooltip />} />
            <Legend
              wrapperStyle={{ paddingTop: '20px' }}
              iconType="circle"
            />
            <Line
              type="monotone"
              dataKey="cardsNew"
              stroke={colorSchemes.progression[0]} // cyan
              name="New Cards"
              strokeWidth={2}
              dot={false}
              isAnimationActive={false}
            />
            <Line
              type="monotone"
              dataKey="cardsLearning"
              stroke={colorSchemes.progression[1]} // blue
              name="Learning Cards"
              strokeWidth={2}
              dot={false}
              isAnimationActive={false}
            />
            <Line
              type="monotone"
              dataKey="cardsMastered"
              stroke={colorSchemes.progression[2]} // green
              name="Mastered Cards"
              strokeWidth={2}
              dot={false}
              isAnimationActive={false}
            />
          </LineChart>
        </ResponsiveContainer>
      </ChartContainer>
    );
  }
);

ProgressLineChart.displayName = 'ProgressLineChart';
```

---

### Template 2: AccuracyAreaChart.tsx

```typescript
// src/components/charts/AccuracyAreaChart.tsx

import React, { useMemo } from 'react';
import {
  AreaChart,
  Area,
  XAxis,
  YAxis,
  CartesianGrid,
  Tooltip,
  ResponsiveContainer,
  TooltipProps,
  Defs,
  LinearGradient,
  Stop,
} from 'recharts';
import { format } from 'date-fns';
import { useProgressData } from '@/hooks/useProgressData';
import { ChartContainer, ChartTooltip } from '@/components/charts';
import { chartColors, getResponsiveHeight } from '@/lib/chartConfig';

interface AccuracyAreaChartProps {
  height?: number;
  className?: string;
}

/**
 * AreaChart visualization of accuracy percentage trend over time
 * Shows accuracy as a filled area with gradient
 *
 * @example
 * ```tsx
 * <AccuracyAreaChart height={300} />
 * ```
 */
export const AccuracyAreaChart = React.forwardRef<HTMLDivElement, AccuracyAreaChartProps>(
  ({ height, className }, ref) => {
    const { progressData, loading, error } = useProgressData();

    // Responsive configuration
    const getResponsiveConfig = () => {
      if (typeof window === 'undefined') {
        return { tickCount: 5, fontSize: 12 };
      }
      const width = window.innerWidth;
      if (width < 768) return { tickCount: 4, fontSize: 10 };
      if (width < 1024) return { tickCount: 6, fontSize: 11 };
      return { tickCount: 8, fontSize: 12 };
    };

    const responsiveConfig = useMemo(() => getResponsiveConfig(), []);
    const chartHeight = height || getResponsiveHeight(typeof window !== 'undefined' ? window.innerWidth : 1024);

    // Format X-axis dates
    const formatXAxis = (dateString: string): string => {
      try {
        const date = new Date(dateString);
        return format(date, 'MMM dd');
      } catch {
        return dateString;
      }
    };

    // Format Y-axis as percentage
    const formatYAxis = (value: number): string => `${Math.round(value)}%`;

    // Custom tooltip
    const CustomTooltip = (props: TooltipProps<number, string>) => {
      const { active, payload, label } = props;
      if (!active || !payload || payload.length === 0) return null;

      return (
        <ChartTooltip
          active={active}
          payload={payload as any}
          label={label}
          labelFormatter={formatXAxis}
          formatter={(value) => `${Math.round(Number(value))}%`}
        />
      );
    };

    // Handle error
    if (error) {
      return (
        <ChartContainer
          ref={ref}
          className={className}
          title="Accuracy Trend"
          description="Your accuracy percentage over time"
          noData
        >
          <div className="text-red-600">Error loading data: {error}</div>
        </ChartContainer>
      );
    }

    // Handle loading
    if (loading) {
      return (
        <ChartContainer
          ref={ref}
          className={className}
          title="Accuracy Trend"
          description="Your accuracy percentage over time"
          loading
          height={chartHeight}
        />
      );
    }

    // Handle empty
    if (!progressData || progressData.length === 0) {
      return (
        <ChartContainer
          ref={ref}
          className={className}
          title="Accuracy Trend"
          description="Your accuracy percentage over time"
          noData
          height={chartHeight}
        />
      );
    }

    return (
      <ChartContainer
        ref={ref}
        className={className}
        title="Accuracy Trend"
        description="Your accuracy percentage over time"
        height={chartHeight}
      >
        <ResponsiveContainer width="100%" height={chartHeight}>
          <AreaChart
            data={progressData}
            margin={{ top: 20, right: 30, left: 0, bottom: 5 }}
          >
            <Defs>
              <LinearGradient id="accuracyGradient" x1="0" y1="0" x2="0" y2="1">
                <Stop offset="0%" stopColor={chartColors.chart1} stopOpacity={0.3} />
                <Stop offset="100%" stopColor={chartColors.chart1} stopOpacity={0.05} />
              </LinearGradient>
            </Defs>
            <CartesianGrid
              strokeDasharray="3 3"
              stroke={chartColors.gray200}
            />
            <XAxis
              dataKey="dateString"
              tick={{ fontSize: responsiveConfig.fontSize, fill: chartColors.gray600 }}
              tickCount={responsiveConfig.tickCount}
              tickFormatter={formatXAxis}
              stroke={chartColors.gray300}
            />
            <YAxis
              domain={[0, 100]}
              tick={{ fontSize: responsiveConfig.fontSize, fill: chartColors.gray600 }}
              stroke={chartColors.gray300}
              tickFormatter={formatYAxis}
            />
            <Tooltip content={<CustomTooltip />} />
            <Area
              type="monotone"
              dataKey="accuracy"
              stroke={chartColors.chart1}
              fill="url(#accuracyGradient)"
              isAnimationActive={false}
              name="Accuracy"
            />
          </AreaChart>
        </ResponsiveContainer>
      </ChartContainer>
    );
  }
);

AccuracyAreaChart.displayName = 'AccuracyAreaChart';
```

---

### Template 3: DeckPerformanceChart.tsx

```typescript
// src/components/charts/DeckPerformanceChart.tsx

import React, { useMemo } from 'react';
import {
  BarChart,
  Bar,
  XAxis,
  YAxis,
  CartesianGrid,
  Tooltip,
  Cell,
  ResponsiveContainer,
  TooltipProps,
} from 'recharts';
import { useDeckPerformance } from '@/hooks/useDeckPerformance';
import { ChartContainer, ChartTooltip } from '@/components/charts';
import { chartColors, colorSchemes, getResponsiveHeight } from '@/lib/chartConfig';
import { DeckPerformanceStats } from '@/types/analytics';

interface DeckPerformanceChartProps {
  height?: number;
  maxDecks?: number;
  className?: string;
}

/**
 * Horizontal BarChart showing deck completion/mastery percentages
 * Allows comparing performance across all decks
 *
 * @example
 * ```tsx
 * <DeckPerformanceChart height={400} />
 * ```
 */
export const DeckPerformanceChart = React.forwardRef<HTMLDivElement, DeckPerformanceChartProps>(
  ({ height, maxDecks = 8, className }, ref) => {
    const { deckStats, loading, error } = useDeckPerformance();

    // Responsive configuration
    const getResponsiveConfig = () => {
      if (typeof window === 'undefined') {
        return { yAxisWidth: 120, fontSize: 12 };
      }
      const width = window.innerWidth;
      if (width < 768) return { yAxisWidth: 100, fontSize: 10 };
      if (width < 1024) return { yAxisWidth: 120, fontSize: 11 };
      return { yAxisWidth: 140, fontSize: 12 };
    };

    const responsiveConfig = useMemo(() => getResponsiveConfig(), []);
    const chartHeight = height || getResponsiveHeight(typeof window !== 'undefined' ? window.innerWidth : 1024);

    // Sort and limit decks
    const sortedDecks = useMemo(() => {
      if (!deckStats) return [];
      return deckStats
        .sort((a, b) => b.mastery - a.mastery)
        .slice(0, maxDecks);
    }, [deckStats, maxDecks]);

    // Format X-axis as percentage
    const formatXAxis = (value: number): string => `${Math.round(value)}%`;

    // Custom tooltip with detailed info
    const CustomTooltip = (props: TooltipProps<number, string>) => {
      const { active, payload } = props;
      if (!active || !payload || payload.length === 0) return null;

      const data = payload[0].payload as DeckPerformanceStats;

      return (
        <ChartTooltip
          active={active}
          payload={[
            {
              name: data.deckName,
              value: `${Math.round(data.mastery)}%`,
              color: colorSchemes.spectrum[sortedDecks.indexOf(data) % 8],
              dataKey: 'mastery',
            },
          ]}
          formatter={(value) => {
            const stat = sortedDecks.find(d => Math.round(d.mastery) === value);
            if (!stat) return String(value);
            return `${Math.round(stat.mastery)}% (${stat.cardsMastered}/${stat.cardsInDeck} cards, ${Math.round(stat.accuracy)}% accuracy)`;
          }}
        />
      );
    };

    // Handle error
    if (error) {
      return (
        <ChartContainer
          ref={ref}
          className={className}
          title="Deck Performance"
          description="Mastery percentage by deck"
          noData
        >
          <div className="text-red-600">Error loading data: {error}</div>
        </ChartContainer>
      );
    }

    // Handle loading
    if (loading) {
      return (
        <ChartContainer
          ref={ref}
          className={className}
          title="Deck Performance"
          description="Mastery percentage by deck"
          loading
          height={chartHeight}
        />
      );
    }

    // Handle empty
    if (!sortedDecks || sortedDecks.length === 0) {
      return (
        <ChartContainer
          ref={ref}
          className={className}
          title="Deck Performance"
          description="Mastery percentage by deck"
          noData
          height={chartHeight}
        />
      );
    }

    return (
      <ChartContainer
        ref={ref}
        className={className}
        title="Deck Performance"
        description="Mastery percentage by deck"
        height={chartHeight}
      >
        <ResponsiveContainer width="100%" height={chartHeight}>
          <BarChart
            data={sortedDecks}
            layout="vertical"
            margin={{ top: 20, right: 30, left: responsiveConfig.yAxisWidth, bottom: 5 }}
          >
            <CartesianGrid
              strokeDasharray="3 3"
              stroke={chartColors.gray200}
            />
            <XAxis
              type="number"
              domain={[0, 100]}
              tick={{ fontSize: responsiveConfig.fontSize, fill: chartColors.gray600 }}
              stroke={chartColors.gray300}
              tickFormatter={formatXAxis}
            />
            <YAxis
              type="category"
              dataKey="deckName"
              width={responsiveConfig.yAxisWidth}
              tick={{ fontSize: responsiveConfig.fontSize, fill: chartColors.gray600 }}
              stroke={chartColors.gray300}
            />
            <Tooltip content={<CustomTooltip />} />
            <Bar
              dataKey="mastery"
              fill={chartColors.chart1}
              isAnimationActive={false}
              radius={[0, 8, 8, 0]}
            >
              {sortedDecks.map((entry, index) => (
                <Cell
                  key={`cell-${index}`}
                  fill={colorSchemes.spectrum[index % 8]}
                />
              ))}
            </Bar>
          </BarChart>
        </ResponsiveContainer>
      </ChartContainer>
    );
  }
);

DeckPerformanceChart.displayName = 'DeckPerformanceChart';
```

---

### Template 4: StageDistributionChart.tsx

```typescript
// src/components/charts/StageDistributionChart.tsx

import React, { useMemo } from 'react';
import {
  PieChart,
  Pie,
  Cell,
  Legend,
  Tooltip,
  ResponsiveContainer,
  TooltipProps,
} from 'recharts';
import { useAnalytics } from '@/hooks/useAnalytics';
import { ChartContainer, ChartTooltip } from '@/components/charts';
import { colorSchemes, getResponsiveHeight } from '@/lib/chartConfig';
import { WordStatusBreakdown } from '@/types/analytics';

interface StageDistributionChartProps {
  height?: number;
  className?: string;
}

interface PieDataItem {
  name: string;
  value: number;
  percent: number;
  original: string;
}

/**
 * PieChart showing distribution of words across learning stages
 * Displays: New, Learning, Review, Mastered, Relearning
 *
 * @example
 * ```tsx
 * <StageDistributionChart height={350} />
 * ```
 */
export const StageDistributionChart = React.forwardRef<HTMLDivElement, StageDistributionChartProps>(
  ({ height, className }, ref) => {
    const { data, loading, error } = useAnalytics();

    // Responsive configuration
    const getResponsiveConfig = () => {
      if (typeof window === 'undefined') {
        return { outerRadius: 100, fontSize: 12 };
      }
      const width = window.innerWidth;
      if (width < 768) return { outerRadius: 80, fontSize: 10 };
      if (width < 1024) return { outerRadius: 100, fontSize: 11 };
      return { outerRadius: 120, fontSize: 12 };
    };

    const responsiveConfig = useMemo(() => getResponsiveConfig(), []);
    const chartHeight = height || getResponsiveHeight(typeof window !== 'undefined' ? window.innerWidth : 1024);

    // Transform WordStatusBreakdown to Pie chart format
    const pieData = useMemo(() => {
      if (!data?.wordStatus) return [];

      const wordStatus = data.wordStatus;
      return [
        {
          name: 'New',
          value: wordStatus.new,
          percent: wordStatus.newPercent,
          original: 'new',
        },
        {
          name: 'Learning',
          value: wordStatus.learning,
          percent: wordStatus.learningPercent,
          original: 'learning',
        },
        {
          name: 'Review',
          value: wordStatus.review,
          percent: wordStatus.reviewPercent,
          original: 'review',
        },
        {
          name: 'Mastered',
          value: wordStatus.mastered,
          percent: wordStatus.masteredPercent,
          original: 'mastered',
        },
        {
          name: 'Relearning',
          value: wordStatus.relearning,
          percent: wordStatus.relearningPercent,
          original: 'relearning',
        },
      ].filter(item => item.value > 0);
    }, [data?.wordStatus]);

    // Stage-specific colors
    const stageColors: Record<string, string> = {
      new: colorSchemes.spectrum[0], // cyan
      learning: colorSchemes.spectrum[1], // blue
      review: colorSchemes.spectrum[2], // green
      mastered: colorSchemes.spectrum[3], // amber
      relearning: colorSchemes.spectrum[4], // red
    };

    // Custom tooltip
    const CustomTooltip = (props: TooltipProps<number, string>) => {
      const { active, payload } = props;
      if (!active || !payload || payload.length === 0) return null;

      const data = payload[0].payload as PieDataItem;

      return (
        <ChartTooltip
          active={active}
          payload={[
            {
              name: data.name,
              value: `${data.value} cards (${Math.round(data.percent)}%)`,
              color: stageColors[data.original],
              dataKey: data.original,
            },
          ]}
        />
      );
    };

    // Custom label renderer for pie slices
    const renderLabel = (entry: PieDataItem): string => {
      return `${Math.round(entry.percent)}%`;
    };

    // Center label showing total count
    const CenterLabel = () => {
      if (!data?.wordStatus) return null;
      const total = data.wordStatus.total;
      return (
        <text
          x="50%"
          y="50%"
          textAnchor="middle"
          dominantBaseline="middle"
          className="fill-foreground font-semibold"
          fontSize={responsiveConfig.fontSize}
        >
          {total} Cards
        </text>
      );
    };

    // Handle error
    if (error) {
      return (
        <ChartContainer
          ref={ref}
          className={className}
          title="Stage Distribution"
          description="Distribution across learning stages"
          noData
        >
          <div className="text-red-600">Error loading data: {error}</div>
        </ChartContainer>
      );
    }

    // Handle loading
    if (loading) {
      return (
        <ChartContainer
          ref={ref}
          className={className}
          title="Stage Distribution"
          description="Distribution across learning stages"
          loading
          height={chartHeight}
        />
      );
    }

    // Handle empty
    if (!data?.wordStatus || data.wordStatus.total === 0 || pieData.length === 0) {
      return (
        <ChartContainer
          ref={ref}
          className={className}
          title="Stage Distribution"
          description="Distribution across learning stages"
          noData
          height={chartHeight}
        />
      );
    }

    return (
      <ChartContainer
        ref={ref}
        className={className}
        title="Stage Distribution"
        description="Distribution across learning stages"
        height={chartHeight}
      >
        <ResponsiveContainer width="100%" height={chartHeight}>
          <PieChart margin={{ top: 20, right: 20, left: 20, bottom: 20 }}>
            <Pie
              data={pieData}
              cx="50%"
              cy="45%"
              outerRadius={responsiveConfig.outerRadius}
              label={renderLabel}
              dataKey="value"
              isAnimationActive={false}
            >
              {pieData.map((entry, index) => (
                <Cell
                  key={`cell-${index}`}
                  fill={stageColors[entry.original]}
                />
              ))}
            </Pie>
            <Tooltip content={<CustomTooltip />} />
            <Legend
              verticalAlign="bottom"
              height={36}
              formatter={(value, entry: any) => `${entry.payload.name} (${Math.round(entry.payload.percent)}%)`}
            />
          </PieChart>
        </ResponsiveContainer>
      </ChartContainer>
    );
  }
);

StageDistributionChart.displayName = 'StageDistributionChart';
```

---

### Updated charts/index.ts

```typescript
// src/components/charts/index.ts

/**
 * Chart components barrel export
 * All visualization components for analytics dashboard
 */

export { ChartContainer } from './ChartContainer';
export { ChartTooltip } from './ChartTooltip';
export { ChartLegend } from './ChartLegend';

// Analytics chart components
export { ProgressLineChart } from './ProgressLineChart';
export { AccuracyAreaChart } from './AccuracyAreaChart';
export { DeckPerformanceChart } from './DeckPerformanceChart';
export { StageDistributionChart } from './StageDistributionChart';
```

---

## Success Criteria

### ProgressLineChart Success Criteria (9 items)

- [ ] **File Created**: `/src/components/charts/ProgressLineChart.tsx` exists with proper TypeScript
- [ ] **Hook Integration**: Component calls `useProgressData()` correctly
- [ ] **Three Lines Display**: Chart renders three separate Line components
- [ ] **Data Keys**: cardsNew, cardsLearning, cardsMastered mapped to data
- [ ] **Color Scheme**: Cyan, Blue, Green colors from progression scheme applied
- [ ] **Responsive**: ChartContainer wrapper with responsive height
- [ ] **Loading State**: Skeleton displays when loading=true
- [ ] **Empty State**: "No data available" message when progressData.length === 0
- [ ] **Tooltip & Legend**: Both visible with proper formatting and labels

### AccuracyAreaChart Success Criteria (7 items)

- [ ] **File Created**: `/src/components/charts/AccuracyAreaChart.tsx` with TypeScript types
- [ ] **Hook Integration**: Component calls `useProgressData()` hook
- [ ] **Area Chart Renders**: AreaChart component displays with single series
- [ ] **Gradient Fill**: LinearGradient definition with opacity fade applied
- [ ] **Y-Axis Percentage**: Domain [0, 100] with % symbol formatting
- [ ] **Responsive**: Responsive height and tick counts
- [ ] **Tooltip Percentage**: Custom tooltip shows percentage values with % sign

### DeckPerformanceChart Success Criteria (9 items)

- [ ] **File Created**: `/src/components/charts/DeckPerformanceChart.tsx` with TypeScript
- [ ] **Hook Integration**: Component calls `useDeckPerformance()` hook
- [ ] **Horizontal Layout**: BarChart with layout="vertical" renders correctly
- [ ] **Color Variety**: Each deck bar has different color from spectrum (8 colors)
- [ ] **Deck Names**: Y-axis displays deckName with responsive width
- [ ] **Mastery Percentage**: X-axis shows mastery values as percentages
- [ ] **Custom Tooltip**: Shows deck name, mastery %, cards, accuracy
- [ ] **Sorting**: Decks sorted by mastery descending (highest first)
- [ ] **Responsive**: Y-axis width and fonts adjust for viewport size

### StageDistributionChart Success Criteria (9 items)

- [ ] **File Created**: `/src/components/charts/StageDistributionChart.tsx` with TypeScript
- [ ] **Hook Integration**: Component calls `useAnalytics()` to get wordStatus
- [ ] **Data Transform**: Pie data correctly transformed from WordStatusBreakdown
- [ ] **Five Slices**: All 5 stages display: New, Learning, Review, Mastered, Relearning
- [ ] **Color Assignment**: Stage-specific colors applied (new→cyan, etc.)
- [ ] **Percentage Labels**: Slice labels show percentages
- [ ] **Center Label**: Total card count displays in center
- [ ] **Custom Tooltip**: Shows stage name, count, and percentage
- [ ] **Legend**: Bottom legend displays all stages with percentages

### Build & Quality Criteria (6 items)

- [ ] **TypeScript Compilation**: `npm run type-check` returns 0 errors
- [ ] **No Warnings**: Zero TypeScript warnings in output
- [ ] **Build Success**: `npm run build` completes successfully
- [ ] **Barrel Export**: All 4 charts exported from `/src/components/charts/index.ts`
- [ ] **Import Verification**: Import statements work from `@/components/charts`
- [ ] **No Breaking Changes**: Existing code unaffected, all imports still valid

### Integration Criteria (5 items)

- [ ] **Imports Work**: All charts importable and no runtime errors
- [ ] **Props Types**: TypeScript accepts height and className props
- [ ] **Hook Dependencies**: All hooks resolve without errors
- [ ] **Color Config**: chartColors and colorSchemes accessible
- [ ] **Chart Config**: getResponsiveHeight and other utilities work

---

## Data Formatting & Utilities

### Date Formatting for X-Axis

```typescript
// Format: "Nov 04", "Dec 15", etc.
import { format } from 'date-fns';

const formatXAxis = (dateString: string): string => {
  try {
    const date = new Date(dateString);
    return format(date, 'MMM dd');
  } catch {
    return dateString; // Fallback to original if parsing fails
  }
};

// Usage in LineChart XAxis:
<XAxis dataKey="dateString" tickFormatter={formatXAxis} />
```

### Percentage Formatting for Y-Axis

```typescript
// Format: "87%", "0%", "100%"
const formatPercentage = (value: number): string => `${Math.round(value)}%`;

// Usage in AreaChart YAxis:
<YAxis domain={[0, 100]} tickFormatter={formatPercentage} />
```

### Number Formatting for Tooltips

```typescript
// Format: "1,234", "342", "5"
const formatNumber = (value: number | string): string => {
  return Number(value).toLocaleString();
};

// Usage in CustomTooltip:
formatter={(value) => formatNumber(value)}
```

### Color Spectrum Assignment

```typescript
// Assign colors cyclically to up to 8 decks
const assignColor = (index: number): string => {
  return colorSchemes.spectrum[index % 8];
};

// Usage in DeckPerformanceChart:
{sortedDecks.map((entry, index) => (
  <Cell key={`cell-${index}`} fill={assignColor(index)} />
))}
```

### Data Transformation for Pie Chart

```typescript
// Transform WordStatusBreakdown to Recharts format
interface PieDataItem {
  name: string;
  value: number;
  percent: number;
  original: string; // For color lookup
}

const transformToChartData = (wordStatus: WordStatusBreakdown): PieDataItem[] => {
  return [
    { name: 'New', value: wordStatus.new, percent: wordStatus.newPercent, original: 'new' },
    { name: 'Learning', value: wordStatus.learning, percent: wordStatus.learningPercent, original: 'learning' },
    { name: 'Review', value: wordStatus.review, percent: wordStatus.reviewPercent, original: 'review' },
    { name: 'Mastered', value: wordStatus.mastered, percent: wordStatus.masteredPercent, original: 'mastered' },
    { name: 'Relearning', value: wordStatus.relearning, percent: wordStatus.relearningPercent, original: 'relearning' },
  ].filter(item => item.value > 0); // Filter out zero values
};
```

---

## Responsive Design Strategy

### Breakpoint Configuration

```typescript
interface ResponsiveConfig {
  height: number;
  tickCount: number;
  fontSize: number;
  yAxisWidth?: number;
  outerRadius?: number;
}

const getResponsiveConfig = (width: number): ResponsiveConfig => {
  if (width < 768) {
    return {
      height: 250,
      tickCount: 4,
      fontSize: 10,
      yAxisWidth: 100,
      outerRadius: 80,
    };
  }
  if (width < 1024) {
    return {
      height: 300,
      tickCount: 6,
      fontSize: 11,
      yAxisWidth: 120,
      outerRadius: 100,
    };
  }
  return {
    height: 350,
    tickCount: 8,
    fontSize: 12,
    yAxisWidth: 140,
    outerRadius: 120,
  };
};
```

### Mobile Optimization (< 768px)

- Chart height: 250px
- X-axis ticks: 4-5 ticks maximum (reduce visual clutter)
- Font size: 10px (smaller labels)
- Y-axis width (for DeckPerformanceChart): 100px
- Pie outer radius: 80px
- Remove dot indicators on line charts
- Simplified tooltip with minimal padding

### Tablet Optimization (768px - 1023px)

- Chart height: 300px
- X-axis ticks: 6-7 ticks
- Font size: 11px
- Y-axis width: 120px
- Pie outer radius: 100px
- Standard tooltip
- Full legend visibility

### Desktop Optimization (1024px+)

- Chart height: 350px
- X-axis ticks: All ticks visible (8+)
- Font size: 12px
- Y-axis width: 140px
- Pie outer radius: 120px
- Full feature set
- Detailed tooltips with all information

### Window Resize Handling

```typescript
// Responsive configuration update on resize
useEffect(() => {
  if (height) return; // Skip if height explicitly provided

  const handleResize = () => {
    setResponsiveHeight(getResponsiveHeight(window.innerWidth));
  };

  window.addEventListener('resize', handleResize);
  return () => window.removeEventListener('resize', handleResize);
}, [height]);
```

---

## Testing & Verification

### Manual Testing Checklist - ProgressLineChart

**Data Display Tests:**
- [ ] Component renders when progressData has 3+ points
- [ ] All three lines visible: New (cyan), Learning (blue), Mastered (green)
- [ ] Lines connect properly between data points
- [ ] X-axis shows dates in "MMM dd" format
- [ ] Y-axis shows numbers (0 to max value)

**State Tests:**
- [ ] Loading state shows skeleton
- [ ] Empty state shows "No data available"
- [ ] Error state displays error message
- [ ] Transitions between states work correctly

**Interaction Tests:**
- [ ] Tooltip appears on hover
- [ ] Tooltip shows correct date, values for all 3 series
- [ ] Legend displays all 3 line names
- [ ] Legend clickable to toggle lines (if configured)

**Responsive Tests:**
- [ ] Mobile (375px): Ticks reduced, font small
- [ ] Tablet (768px): Standard appearance
- [ ] Desktop (1024px): Full detail visible
- [ ] Resize event updates configuration

---

### Manual Testing Checklist - AccuracyAreaChart

**Data Display Tests:**
- [ ] Component renders with area chart
- [ ] Area fills with blue color and gradient
- [ ] Gradient transitions from opaque to transparent
- [ ] X-axis shows dates in "MMM dd" format
- [ ] Y-axis shows percentages 0-100% with % symbols

**State Tests:**
- [ ] Loading state shows skeleton
- [ ] Empty state shows "No data available"
- [ ] Error state displays message
- [ ] No crash with single data point

**Interaction Tests:**
- [ ] Tooltip appears on hover
- [ ] Tooltip shows date and percentage value
- [ ] Percentage formatted with % symbol
- [ ] No legend required (single series)

**Visual Tests:**
- [ ] Gradient visible (not solid color)
- [ ] Area opacity correct (not too transparent)
- [ ] Respects responsive height

---

### Manual Testing Checklist - DeckPerformanceChart

**Data Display Tests:**
- [ ] Component renders horizontal bar chart
- [ ] Each deck has separate bar
- [ ] Bars sorted by mastery descending (best first)
- [ ] Bar colors differ (spectrum colors applied)
- [ ] Y-axis shows deck names
- [ ] X-axis shows percentages 0-100%

**State Tests:**
- [ ] Loading state shows skeleton
- [ ] Empty state shows "No deck data available"
- [ ] Error state displays message
- [ ] Works with 1-8 decks

**Interaction Tests:**
- [ ] Tooltip shows deck name
- [ ] Tooltip shows mastery percentage
- [ ] Tooltip shows card count and accuracy
- [ ] Y-axis width responsive

**Data Tests:**
- [ ] Mastery = (cardsMastered / cardsInDeck) × 100
- [ ] Sorted correctly by mastery
- [ ] All decks included up to maxDecks (default 8)

---

### Manual Testing Checklist - StageDistributionChart

**Data Display Tests:**
- [ ] Component renders pie chart
- [ ] All non-zero stages represented
- [ ] Slice sizes proportional to values
- [ ] Percentages shown on slices
- [ ] Total count shown in center
- [ ] Colors match stages: new→cyan, learning→blue, review→green, etc.

**State Tests:**
- [ ] Loading state shows skeleton
- [ ] Empty state shows "No stage data available"
- [ ] Works with 2-5 stages (not all always present)

**Interaction Tests:**
- [ ] Tooltip shows stage name
- [ ] Tooltip shows count and percentage
- [ ] Legend shows all stages with percentages
- [ ] Legend doesn't overlap chart

**Data Tests:**
- [ ] Percentages sum to ~100%
- [ ] Only stages with count > 0 display
- [ ] Total in center matches sum of all stages

---

### Integration Tests

**Import Tests:**
```typescript
// Should work without errors
import {
  ProgressLineChart,
  AccuracyAreaChart,
  DeckPerformanceChart,
  StageDistributionChart,
} from '@/components/charts';
```

**TypeScript Tests:**
```bash
npm run type-check  # Should return 0 errors, 0 warnings
```

**Build Tests:**
```bash
npm run build  # Should complete successfully
```

**Dashboard Integration Test:**
```typescript
// Should render all 4 charts in a grid
<div className="grid grid-cols-1 md:grid-cols-2 gap-6">
  <ProgressLineChart />
  <AccuracyAreaChart />
  <DeckPerformanceChart />
  <StageDistributionChart />
</div>
```

---

## Timeline Breakdown

### Detailed Time Allocation

| Task | Duration | Notes |
|------|----------|-------|
| **ProgressLineChart** | 20 min | Longest due to 3 lines |
| Setup & hook integration | 4 min | |
| Chart structure with 3 lines | 10 min | Recharts LineChart config |
| Responsive config & testing | 4 min | Mobile/tablet/desktop |
| Error/loading/empty states | 2 min | |
| **AccuracyAreaChart** | 15 min | Gradient adds complexity |
| Setup & data validation | 3 min | |
| Chart + gradient implementation | 8 min | LinearGradient + Area config |
| Percentage formatting & responsive | 3 min | Y-axis formatter |
| Testing (load/error/empty) | 1 min | |
| **DeckPerformanceChart** | 20 min | Horizontal layout + sorting |
| Setup & deck sorting logic | 4 min | Sort by mastery descending |
| Horizontal bar implementation | 8 min | BarChart layout="vertical" |
| Per-bar coloring (8 colors) | 4 min | Cell components for spectrum |
| Custom tooltip & responsive | 4 min | Y-axis width adjustments |
| **StageDistributionChart** | 15 min | Pie chart with transformation |
| Setup & data transformation | 4 min | WordStatusBreakdown → pie data |
| Pie chart implementation | 6 min | Pie + Cell + custom labels |
| Stage colors & center label | 3 min | Color mapping + center text |
| Legend & responsive | 2 min | |
| **Integration & Verification** | 5 min | Final checks |
| Update charts/index.ts | 1 min | Barrel export |
| TypeScript compilation | 2 min | Fix any errors |
| Build verification | 1 min | npm run build |
| Final testing | 1 min | Manual spot checks |
| **Total** | **75 min** | |

---

## Files Summary

### New Files to Create

#### 1. ProgressLineChart.tsx
- **Path**: `/Users/samosipov/Downloads/learn-greek-easy/learn-greek-easy-frontend/src/components/charts/ProgressLineChart.tsx`
- **Purpose**: Line chart showing three word status trends over time
- **Estimated Lines**: 180-200 lines
- **Key Exports**: `ProgressLineChart` component
- **Dependencies**: useProgressData, ChartContainer, ChartTooltip, colorSchemes.progression
- **Data**: ProgressDataPoint[] (cardsNew, cardsLearning, cardsMastered)

#### 2. AccuracyAreaChart.tsx
- **Path**: `/Users/samosipov/Downloads/learn-greek-easy/learn-greek-easy-frontend/src/components/charts/AccuracyAreaChart.tsx`
- **Purpose**: Area chart with gradient fill showing accuracy trend
- **Estimated Lines**: 160-180 lines
- **Key Exports**: `AccuracyAreaChart` component
- **Dependencies**: useProgressData, ChartContainer, ChartTooltip, chartColors.chart1, Defs, LinearGradient
- **Data**: ProgressDataPoint[] (accuracy field only)

#### 3. DeckPerformanceChart.tsx
- **Path**: `/Users/samosipov/Downloads/learn-greek-easy/learn-greek-easy-frontend/src/components/charts/DeckPerformanceChart.tsx`
- **Purpose**: Horizontal bar chart comparing deck mastery percentages
- **Estimated Lines**: 200-220 lines
- **Key Exports**: `DeckPerformanceChart` component
- **Dependencies**: useDeckPerformance, ChartContainer, ChartTooltip, colorSchemes.spectrum, Cell
- **Data**: DeckPerformanceStats[] (deckName, mastery, cardsMastered, cardsInDeck, accuracy)

#### 4. StageDistributionChart.tsx
- **Path**: `/Users/samosipov/Downloads/learn-greek-easy/learn-greek-easy-frontend/src/components/charts/StageDistributionChart.tsx`
- **Purpose**: Pie chart showing distribution across 5 learning stages
- **Estimated Lines**: 210-240 lines
- **Key Exports**: `StageDistributionChart` component
- **Dependencies**: useAnalytics, ChartContainer, ChartTooltip, colorSchemes.spectrum, Cell, Pie
- **Data**: WordStatusBreakdown (new, learning, review, mastered, relearning counts)

### Files to Modify

#### 1. charts/index.ts
- **Path**: `/Users/samosipov/Downloads/learn-greek-easy/learn-greek-easy-frontend/src/components/charts/index.ts`
- **Change**: Add exports for 4 new chart components
- **Before**: 3 exports (ChartContainer, ChartTooltip, ChartLegend)
- **After**: 7 exports (add ProgressLineChart, AccuracyAreaChart, DeckPerformanceChart, StageDistributionChart)
- **Lines Added**: 4-5 lines

### Existing Files (No Changes Required)

- `/src/lib/chartConfig.ts` - Contains all color definitions (no changes)
- `/src/components/charts/ChartContainer.tsx` - Wrapper component (no changes)
- `/src/components/charts/ChartTooltip.tsx` - Tooltip component (no changes)
- `/src/components/charts/ChartLegend.tsx` - Legend component (no changes)
- `/src/hooks/useProgressData.ts` - Hook for progress data (no changes)
- `/src/hooks/useDeckPerformance.ts` - Hook for deck stats (no changes)
- `/src/hooks/useAnalytics.ts` - Hook for analytics data (no changes)

### Total Code to Write

- **New Lines of Code**: ~750-840 lines (all 4 components)
- **Modified Lines**: ~5-6 lines (in index.ts)
- **Test Cases**: Manual testing per checklist above
- **Time Estimate**: 75 minutes

---

## Integration Examples

### Dashboard Page Integration

```typescript
// src/pages/AnalyticsDashboard.tsx (example usage)

import React from 'react';
import {
  ProgressLineChart,
  AccuracyAreaChart,
  DeckPerformanceChart,
  StageDistributionChart,
} from '@/components/charts';
import { useAnalytics } from '@/hooks/useAnalytics';

export function AnalyticsDashboard() {
  const { data, loading, error, refresh } = useAnalytics(true);

  if (error) {
    return (
      <div className="p-6">
        <div className="text-red-600">Error loading analytics: {error}</div>
        <button onClick={refresh} className="mt-4 px-4 py-2 bg-blue-600 text-white rounded">
          Retry
        </button>
      </div>
    );
  }

  return (
    <div className="space-y-6 p-6">
      {/* Header */}
      <div className="flex justify-between items-center">
        <h1 className="text-3xl font-bold">Analytics Dashboard</h1>
        <button
          onClick={refresh}
          disabled={loading}
          className="px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50"
        >
          Refresh
        </button>
      </div>

      {/* Charts Grid - 2 columns on desktop, 1 on mobile */}
      <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
        {/* Row 1 */}
        <ProgressLineChart height={350} />
        <AccuracyAreaChart height={350} />

        {/* Row 2 */}
        <DeckPerformanceChart height={400} />
        <StageDistributionChart height={400} />
      </div>
    </div>
  );
}
```

### Component Usage - Individual Charts

```typescript
// Using ProgressLineChart standalone
<ProgressLineChart height={300} className="mb-6" />

// Using AccuracyAreaChart with custom height
<AccuracyAreaChart height={250} />

// Using DeckPerformanceChart with max decks limit
<DeckPerformanceChart height={400} maxDecks={8} />

// Using StageDistributionChart
<StageDistributionChart height={350} className="w-full" />
```

### Props Examples

```typescript
// ProgressLineChart - all optional props with defaults
<ProgressLineChart
  height={350}  // Optional: defaults to responsive height
  className="mb-6"  // Optional: custom CSS classes
/>

// DeckPerformanceChart - with max decks limit
<DeckPerformanceChart
  height={400}
  maxDecks={8}  // Optional: limits decks shown, defaults to 8
  className="border rounded-lg"
/>

// All charts support these common props:
// - height?: number - explicit height in pixels
// - className?: string - additional CSS classes
// - ref?: React.Ref - for accessing DOM element
```

---

## Known Constraints & Decisions

### Design Decisions

1. **No Animation**: Set `isAnimationActive={false}` on all chart components
   - Reason: Reduces render time, improves performance on low-end devices
   - Implication: Charts load instantly without animation sequence

2. **Single Series Per Line**: ProgressLineChart uses 3 separate Line components (not customShaped)
   - Reason: Simpler implementation, easier to understand and modify
   - Implication: Clear legend with 3 distinct entries

3. **Horizontal Bars for Deck Comparison**: Uses `layout="vertical"` BarChart
   - Reason: Deck names fit better on Y-axis than rotated labels on X-axis
   - Implication: Better readability for mobile/tablet screens

4. **Pie Chart over Donut**: Uses standard Pie (not Donut) for stage distribution
   - Reason: Simpler, more straightforward for this use case
   - Implication: Center label shows total count without competing with ring

5. **No Data Table Export**: Charts are visualization-only, no data export
   - Reason: Out of scope for Task 06.04
   - Implication: Users cannot download chart data (future enhancement)

### Constraints

1. **Recharts 3.3.0**: Using installed version, no upgrades planned
   - Constraint: Feature set limited to 3.3.0 capabilities
   - Workaround: All required features available in 3.3.0

2. **No Backend Integration**: Using localStorage mock data only
   - Constraint: Chart data from frontend stores only
   - Implication: Real-time sync not possible in MVP

3. **Desktop-First Design**: Responsive, but optimized for desktop
   - Constraint: Mobile viewport < 768px has reduced features
   - Implication: Some detail hidden on small screens (by design)

4. **No Custom Recharts Shapes**: Using standard Bar, Line, Area, Pie
   - Constraint: Cannot use custom chart shapes
   - Implication: Charts follow Recharts conventions

5. **TypeScript Strict Mode**: All components must pass strict type checking
   - Constraint: No `any` types, proper typing required
   - Implication: More verbose code, but safer

### Performance Considerations

1. **useMemo for Responsive Config**: Caches responsive calculations
   - Benefit: Reduces re-computation on re-render
   - Trade-off: Minimal memory overhead

2. **No Ref Callbacks**: ChartContainer uses React.forwardRef
   - Benefit: Parent can access DOM element if needed
   - Trade-off: Adds complexity for rarely-used feature

3. **Chart Height Calculation**: Cached in useMemo
   - Benefit: Efficient responsive behavior
   - Trade-off: Requires window object (SSR incompatible)

4. **Data Sorting in useMemo**: DeckPerformanceChart sorts data once
   - Benefit: Prevents re-sorting on every render
   - Trade-off: Updated data requires new sort

---

## Next Steps

### Task 06.05 Dependencies

Task 06.05 (Dashboard Layout Integration) will depend on:
1. All 4 chart components exported and accessible
2. TypeScript compilation succeeding (0 errors)
3. Build completing successfully
4. Charts ready for dashboard grid layout

### Files Task 06.05 Will Import

```typescript
import {
  ProgressLineChart,
  AccuracyAreaChart,
  DeckPerformanceChart,
  StageDistributionChart,
} from '@/components/charts';
```

### Expected Dashboard Structure (Task 06.05)

Task 06.05 will create dashboard layout like:
```
┌─────────────────────────────────────────────────┐
│  Analytics Dashboard                    Refresh  │
├─────────────────────────────────────────────────┤
│  ┌──────────────────┬──────────────────────────┐ │
│  │ ProgressLine     │ AccuracyArea             │ │
│  │ Chart            │ Chart                    │ │
│  └──────────────────┴──────────────────────────┘ │
│  ┌──────────────────┬──────────────────────────┐ │
│  │ DeckPerformance  │ StageDistribution        │ │
│  │ Chart            │ Chart                    │ │
│  └──────────────────┴──────────────────────────┘ │
└─────────────────────────────────────────────────┘
```

### Verification Checklist for Task Handoff

Before proceeding to Task 06.05:

- [ ] All 4 charts created at correct file paths
- [ ] TypeScript: `npm run type-check` returns 0 errors
- [ ] Build: `npm run build` succeeds
- [ ] Exports: All 4 charts exported from charts/index.ts
- [ ] Imports: Can import all 4 charts in test file
- [ ] Components: Render without errors when passed mock data
- [ ] Responsive: Work at 375px (mobile), 768px (tablet), 1024px (desktop)
- [ ] States: Handle loading, error, and empty states gracefully
- [ ] Git: Changes staged and ready for commit

---

## Document Metadata

**Status**: READY FOR EXECUTION
**Version**: 1.0
**Last Updated**: November 4, 2025
**Document Owner**: Senior System Analyst

**Key Sections for Executor**:
- [Complete Code Templates](#complete-code-templates) - Copy-paste ready code
- [Implementation Steps](#implementation-steps) - Detailed step-by-step guide
- [Success Criteria](#success-criteria) - Verification checklist
- [Testing & Verification](#testing--verification) - Manual test procedures

**Questions or Blockers**: Review [Known Constraints & Decisions](#known-constraints--decisions) section and [Architecture Analysis](#architecture-analysis) for context.

---

## Appendix: Troubleshooting Guide

### Issue: "Cannot find module '@/hooks/useProgressData'"

**Solution**: Verify Tasks 06.02 completed successfully and hooks exported from @/hooks

**Verification**:
```bash
ls -la /Users/samosipov/Downloads/learn-greek-easy/learn-greek-easy-frontend/src/hooks/
# Should show: useProgressData.ts, useDeckPerformance.ts, useAnalytics.ts
```

---

### Issue: "Property 'accuracy' does not exist on type 'ProgressDataPoint'"

**Solution**: Verify analytics.ts types include all required properties

**Fix**: If missing, add to ProgressDataPoint in types/analytics.ts

---

### Issue: "Recharts component not rendering - blank chart"

**Solution**: Check data is being passed correctly

**Debug**:
```typescript
// Add console.log to verify data
console.log('progressData:', progressData);
console.log('data length:', progressData?.length);
```

---

### Issue: "Chart cuts off at edges or colors look wrong"

**Solution**: Check responsive height and color values

**Fix**: Verify chartConfig margin and colorSchemes in chartConfig.ts

---

### Issue: "TypeScript errors after implementation"

**Solution**: Run type-check and address errors individually

**Command**:
```bash
npm run type-check 2>&1 | head -20
# Review first 20 errors
```

---

**END OF DOCUMENT**

---

## TASK COMPLETION VERIFICATION (Added November 4, 2025)

### Verification Results: ✅ COMPLETE - Grade A (45/47 criteria met - 95.7%)

**Verification Date:** November 4, 2025
**Verifier:** System Analyst
**Build Status:** ✅ SUCCESS (0 TypeScript errors, build time 1.39s)
**Bundle Size:** 493.89 KB (well under 600 KB limit)

### Component-by-Component Results:

#### 1. ProgressLineChart: 11/11 ✅
- ✅ File created (193 lines)
- ✅ 3 lines display (New, Learning, Mastered)
- ✅ Uses useProgressData() hook
- ✅ Responsive design implemented
- ✅ Loading/error/empty states working
- ✅ Progression color scheme (cyan, blue, green)
- ✅ Date formatting via date-fns
- ✅ Custom tooltip with ChartTooltip
- ✅ Legend configured
- ✅ TypeScript types defined

#### 2. AccuracyAreaChart: 10/10 ✅
- ✅ File created (179 lines)
- ✅ Area chart with gradient rendering
- ✅ Uses useProgressData() hook
- ✅ Responsive design implemented
- ✅ Loading/error/empty states working
- ✅ Y-axis as percentages (0-100%)
- ✅ Date formatting on X-axis
- ✅ Custom tooltip with % formatter
- ✅ Blue gradient fill
- ✅ TypeScript types defined

#### 3. DeckPerformanceChart: 10/10 ✅
- ✅ File created (187 lines)
- ✅ Horizontal bar chart (layout="vertical")
- ✅ Uses useDeckPerformance() hook
- ✅ Responsive design implemented
- ✅ Loading/error/empty states working
- ✅ Spectrum color scheme (8 colors via Cell)
- ✅ Sorted by mastery descending
- ✅ X-axis shows percentages
- ✅ Y-axis shows deck names
- ✅ TypeScript types defined

#### 4. StageDistributionChart: 8/9 ⚠️ (1 minor deviation)
- ✅ File created (217 lines)
- ✅ Pie chart rendering
- ✅ Uses useAnalytics() hook
- ✅ Responsive design implemented
- ✅ Loading/error/empty states working
- ✅ Shows 5 stages (New, Learning, Review, Mastered, Relearning)
- ⚠️ Stage colors implemented but mapping differs from spec (functional, visually distinct)
- ✅ Percentage labels on slices
- ✅ TypeScript types defined

#### 5. Integration & Build: 7/7 ✅
- ✅ All 4 components exported from index.ts
- ✅ date-fns installed (package.json)
- ✅ TypeScript compilation: 0 errors
- ✅ Build successful (1.39s)
- ✅ Bundle size: 493.89 KB (acceptable)
- ✅ ChartContainer wrapper used
- ✅ chartConfig theming used

### Minor Issues Identified:
1. **StageDistributionChart color mapping:** Uses different spectrum indices than spec but achieves same goal (visually distinct colors). Impact: Minimal. Recommendation: Update for consistency (low priority).

### Code Quality Assessment:
- ✅ Consistent architecture across all components
- ✅ Comprehensive error handling (loading/error/empty/success states)
- ✅ TypeScript strict mode compliance
- ✅ Responsive design with viewport-based configuration
- ✅ Performance optimizations (useMemo, no animations)
- ✅ Accessibility considerations

### Files Created/Modified:
**New Files (4):**
1. `/src/components/charts/ProgressLineChart.tsx` (193 lines)
2. `/src/components/charts/AccuracyAreaChart.tsx` (179 lines)
3. `/src/components/charts/DeckPerformanceChart.tsx` (187 lines)
4. `/src/components/charts/StageDistributionChart.tsx` (217 lines)

**Modified Files (1):**
1. `/src/components/charts/index.ts` (added 4 exports)

**Total New Code:** 776 lines

### Next Steps:
- ✅ Task 06.04 COMPLETE - Ready for Task 06.05 (Dashboard Layout Integration)
- All charts available for import: `@/components/charts`
- Hooks providing real data from stores
- No blockers for dashboard integration

---

## Quick Reference Card

For busy executors - key points at a glance:

| Component | Hook | Data Key | Chart Type | Colors | Time |
|-----------|------|----------|-----------|--------|------|
| ProgressLineChart | useProgressData() | cardsNew/Learning/Mastered | LineChart | progression (3) | 20 min |
| AccuracyAreaChart | useProgressData() | accuracy | AreaChart | chart1 (blue) | 15 min |
| DeckPerformanceChart | useDeckPerformance() | mastery | BarChart (horiz) | spectrum (8) | 20 min |
| StageDistributionChart | useAnalytics() | wordStatus | PieChart | spectrum (5) | 15 min |

**Total**: 75 minutes | **Files**: 4 new + 1 modified | **Tests**: Manual checklist above
