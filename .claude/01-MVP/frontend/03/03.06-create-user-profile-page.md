# Task 03.06: Create User Profile Page

**Status**: âœ… Completed
**Estimated Duration**: 75 minutes
**Priority**: Medium
**Dependencies**: Task 03.05 (Protected Routes) âœ… Completed

---

## Overview

The User Profile Page serves as the personal hub for users in the Learn Greek Easy application. It provides a comprehensive interface for viewing learning progress, managing personal information, customizing preferences, and handling security settings. The page features a two-column layout with a navigation sidebar and dynamic content sections, fully responsive across all devices.

**Business Value**: Increases user engagement through visible progress tracking, reduces support requests via self-service profile management, and provides foundation for future gamification features.

---

## Objectives

1. Create a comprehensive profile management interface with sidebar navigation
2. Implement personal information editing with form validation
3. Display learning statistics and achievement badges
4. Enable preference customization for personalized learning
5. Provide security settings with placeholder functionality
6. Ensure full mobile responsiveness with adaptive layouts
7. Integrate seamlessly with existing auth store and user data

---

## Component Architecture

### Files to Create

1. **`/src/pages/Profile.tsx`**
   Main profile page component with layout structure and section routing

2. **`/src/components/profile/ProfileHeader.tsx`**
   User avatar, name, role badge, and account overview

3. **`/src/components/profile/PersonalInfoSection.tsx`**
   Form for editing user name and viewing account details

4. **`/src/components/profile/StatsSection.tsx`**
   Learning statistics, progress visualization, and achievements

5. **`/src/components/profile/PreferencesSection.tsx`**
   Learning preferences including language, daily goals, and notifications

6. **`/src/components/profile/SecuritySection.tsx`**
   Password management and account security settings

### Component Interfaces

```typescript
// Profile Form Types
interface ProfileFormData {
  name: string;
  email: string; // read-only
  avatar?: File; // placeholder only
}

interface PreferencesFormData {
  language: 'en' | 'el';
  dailyGoal: number; // 5-120 minutes
  notifications: boolean;
  theme?: 'light' | 'dark';
}

interface PasswordFormData {
  currentPassword: string;
  newPassword: string;
  confirmPassword: string;
}

// Component Props
interface ProfileHeaderProps {
  user: User;
  onAvatarClick?: () => void;
}

interface ProfileStatsProps {
  stats: UserStats;
  showDetails?: boolean;
}

// Navigation State
type ProfileSection = 'personal' | 'stats' | 'preferences' | 'security';

interface ProfileNavigationProps {
  activeSection: ProfileSection;
  onSectionChange: (section: ProfileSection) => void;
}
```

---

## Implementation Steps

### Step 1: Create Profile Page Layout Structure (15 minutes)

Create the main profile page with responsive two-column layout featuring sidebar navigation and dynamic content area.

**File**: `/src/pages/Profile.tsx`

```typescript
import React, { useState } from 'react';
import { useAuth } from '@/hooks/useAuth';
import { Card } from '@/components/ui/card';
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';
import { Button } from '@/components/ui/button';
import { User, Settings, BarChart3, Shield, Menu, X } from 'lucide-react';
import { cn } from '@/lib/utils';

// Import section components
import { ProfileHeader } from '@/components/profile/ProfileHeader';
import { PersonalInfoSection } from '@/components/profile/PersonalInfoSection';
import { StatsSection } from '@/components/profile/StatsSection';
import { PreferencesSection } from '@/components/profile/PreferencesSection';
import { SecuritySection } from '@/components/profile/SecuritySection';

const Profile: React.FC = () => {
  const { user } = useAuth();
  const [activeSection, setActiveSection] = useState<ProfileSection>('personal');
  const [isSidebarOpen, setIsSidebarOpen] = useState(false);

  // Navigation items configuration
  const navigationItems = [
    { id: 'personal' as ProfileSection, label: 'Personal Info', icon: User },
    { id: 'stats' as ProfileSection, label: 'Statistics', icon: BarChart3 },
    { id: 'preferences' as ProfileSection, label: 'Preferences', icon: Settings },
    { id: 'security' as ProfileSection, label: 'Security', icon: Shield },
  ];

  return (
    <div className="min-h-screen bg-gray-50">
      <div className="container mx-auto px-4 py-6 max-w-7xl">
        {/* Mobile header with hamburger menu */}
        {/* Desktop: Two-column grid with sidebar and main content */}
        {/* Mobile: Tabs for section navigation */}
      </div>
    </div>
  );
};
```

**Success Criteria:**
- âœ… Profile page component created at `/src/pages/Profile.tsx`
- âœ… Two-column layout implemented (sidebar + main content)
- âœ… Mobile responsive with collapsible sidebar
- âœ… Basic routing added to App.tsx
- âœ… TypeScript interfaces defined

### Step 2: Implement Profile Header Component (10 minutes)

Build the profile header displaying user avatar with fallback initials, name, email, and role badge.

**File**: `/src/components/profile/ProfileHeader.tsx`

```typescript
export const ProfileHeader: React.FC<ProfileHeaderProps> = ({ user, onAvatarClick }) => {
  const initials = user.name
    .split(' ')
    .map(n => n[0])
    .join('')
    .toUpperCase()
    .slice(0, 2);

  return (
    <div className="p-6 border-b border-gray-200">
      <div className="flex flex-col md:flex-row items-center md:items-start gap-6">
        {/* Avatar with camera button overlay */}
        {/* User info with name, role badge, and metadata */}
      </div>
    </div>
  );
};
```

**Success Criteria:**
- âœ… Avatar displayed with fallback initials
- âœ… User name and email shown
- âœ… Role badge with appropriate color (purple for premium, red for admin, gray for free)
- âœ… Edit mode toggle button
- âœ… Responsive layout on mobile

### Step 3: Build Personal Information Form (15 minutes)

Create the personal information section with editable name field, read-only email, and placeholder avatar upload.

**File**: `/src/components/profile/PersonalInfoSection.tsx`

```typescript
const profileSchema = z.object({
  name: z.string()
    .min(2, 'Name must be at least 2 characters')
    .max(50, 'Name must be less than 50 characters')
    .regex(/^[a-zA-Z\s'-]+$/, 'Name can only contain letters, spaces, hyphens and apostrophes'),
});

export const PersonalInfoSection: React.FC<PersonalInfoSectionProps> = ({ user }) => {
  const updateProfile = useAuthStore((state) => state.updateProfile);
  const [isLoading, setIsLoading] = useState(false);

  const { register, handleSubmit, formState: { errors, isDirty } } = useForm<ProfileFormData>({
    resolver: zodResolver(profileSchema),
    defaultValues: { name: user.name },
  });

  const onSubmit = async (data: ProfileFormData) => {
    setIsLoading(true);
    try {
      await updateProfile({ name: data.name });
      toast.success('Profile updated successfully!');
    } catch (error) {
      toast.error('Failed to update profile. Please try again.');
    } finally {
      setIsLoading(false);
    }
  };

  return (
    // Form with name input, read-only email, avatar upload button, and save button
  );
};
```

**Success Criteria:**
- âœ… Form displays current user data
- âœ… Name field editable (2-50 chars validation)
- âœ… Email field read-only with lock icon
- âœ… Avatar upload UI (placeholder functionality)
- âœ… Save button with loading state
- âœ… Success toast on update

### Step 4: Create Statistics Display Section (10 minutes)

Build the statistics section showing streak counter, words learned, XP progress, achievements, and motivational messages.

**File**: `/src/components/profile/StatsSection.tsx`

```typescript
export const StatsSection: React.FC<StatsSectionProps> = ({ stats }) => {
  const level = Math.floor(stats.totalXP / 1000) || 1;
  const currentLevelXP = stats.totalXP % 1000;
  const nextLevelXP = 1000;
  const progressPercent = (currentLevelXP / nextLevelXP) * 100;

  const getStreakMessage = (streak: number) => {
    if (streak >= 30) return "Incredible! You're on fire! ğŸ”¥";
    if (streak >= 14) return "Amazing streak! Keep it up! ğŸ’ª";
    if (streak >= 7) return "Great job! One week strong! ğŸŒŸ";
    if (streak >= 3) return "Nice start! Keep going! ğŸ‘";
    return "Start your learning streak today! ğŸš€";
  };

  return (
    // Stats cards grid with icons
    // Level progress bar
    // Achievement badges placeholder
    // Recent activity timeline
  );
};
```

**Success Criteria:**
- âœ… Streak counter with flame icon
- âœ… Words learned with progress indicator
- âœ… Total XP with level calculation (every 1000 XP = 1 level)
- âœ… Join date and last activity
- âœ… Visual charts or progress bars
- âœ… Motivational messages based on stats

### Step 5: Implement Preferences Management (10 minutes)

Create preferences section with language selector, daily goal slider, and notification toggle with auto-save functionality.

**File**: `/src/components/profile/PreferencesSection.tsx`

```typescript
export const PreferencesSection: React.FC<PreferencesSectionProps> = ({ user }) => {
  const updateProfile = useAuthStore((state) => state.updateProfile);
  const [preferences, setPreferences] = useState(user.preferences);

  // Debounced save function for auto-save
  const debouncedSave = useCallback(
    debounce(async (newPreferences: typeof preferences) => {
      try {
        await updateProfile({ preferences: newPreferences });
        toast.success('Preferences updated successfully');
      } catch (error) {
        toast.error('Failed to save preferences');
      }
    }, 1000),
    [updateProfile]
  );

  const handlePreferenceChange = (key: keyof typeof preferences, value: any) => {
    const newPreferences = { ...preferences, [key]: value };
    setPreferences(newPreferences);
    debouncedSave(newPreferences);
  };

  return (
    // Language selector (English/Greek)
    // Daily goal slider (5-120 minutes)
    // Notifications toggle switch
    // Theme selector (disabled - coming soon)
  );
};
```

**Success Criteria:**
- âœ… Language selector (English/Greek)
- âœ… Daily goal slider (5-120 minutes)
- âœ… Notifications toggle switch
- âœ… Theme selector (future feature - disabled)
- âœ… Instant save on change with debounce
- âœ… Visual feedback for updates

### Step 6: Add Security Section with Placeholders (10 minutes)

Implement security settings with password change form, account deletion dialog, and session management display.

**File**: `/src/components/profile/SecuritySection.tsx`

```typescript
const passwordSchema = z.object({
  currentPassword: z.string().min(1, 'Current password is required'),
  newPassword: z.string()
    .min(8, 'Password must be at least 8 characters')
    .regex(/[A-Z]/, 'Password must contain at least one uppercase letter')
    .regex(/[a-z]/, 'Password must contain at least one lowercase letter')
    .regex(/[0-9]/, 'Password must contain at least one number'),
  confirmPassword: z.string(),
}).refine((data) => data.newPassword === data.confirmPassword, {
  message: "Passwords don't match",
  path: ['confirmPassword'],
});

export const SecuritySection: React.FC = () => {
  const onPasswordSubmit = async (data: PasswordFormData) => {
    // Simulate API call
    await new Promise(resolve => setTimeout(resolve, 1000));
    toast.info('Password change feature coming soon!');
    reset();
  };

  return (
    // Password change form
    // Two-factor auth toggle (disabled)
    // Active sessions display
    // Account deletion with confirmation dialog
  );
};
```

**Success Criteria:**
- âœ… Password change form (UI only)
- âœ… Form validation for password rules
- âœ… Account deletion button with dialog
- âœ… Two-factor auth toggle (disabled - coming soon)
- âœ… Session management info

### Step 7: Implement Mobile Navigation & Polish (5 minutes)

Add mobile menu toggle, section transitions, loading states, and keyboard navigation support.

**Mobile Considerations:**
- Hamburger menu for sidebar on mobile
- Horizontal tabs as alternative navigation
- Touch-friendly interaction areas
- Proper viewport handling

**Success Criteria:**
- âœ… Hamburger menu for mobile sidebar
- âœ… Smooth section transitions
- âœ… Loading states for all actions
- âœ… Error handling with user feedback
- âœ… Keyboard navigation support

---

## Form Validation

### Profile Form Schema
```typescript
const profileSchema = z.object({
  name: z.string()
    .min(2, 'Name must be at least 2 characters')
    .max(50, 'Name must be less than 50 characters')
    .regex(/^[a-zA-Z\s'-]+$/, 'Name can only contain letters, spaces, hyphens and apostrophes'),
  email: z.string().email(), // Read-only, no validation needed
});
```

### Preferences Schema
```typescript
const preferencesSchema = z.object({
  language: z.enum(['en', 'el']),
  dailyGoal: z.number()
    .min(5, 'Minimum daily goal is 5 minutes')
    .max(120, 'Maximum daily goal is 120 minutes'),
  notifications: z.boolean(),
  theme: z.enum(['light', 'dark']).optional(),
});
```

### Password Schema
```typescript
const passwordSchema = z.object({
  currentPassword: z.string().min(1, 'Current password is required'),
  newPassword: z.string()
    .min(8, 'Password must be at least 8 characters')
    .regex(/[A-Z]/, 'Password must contain at least one uppercase letter')
    .regex(/[a-z]/, 'Password must contain at least one lowercase letter')
    .regex(/[0-9]/, 'Password must contain at least one number'),
  confirmPassword: z.string(),
}).refine((data) => data.newPassword === data.confirmPassword, {
  message: "Passwords don't match",
  path: ['confirmPassword'],
});
```

---

## Layout Design

### Desktop Layout (>768px)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Profile                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Sidebar     â”‚  Main Content Area           â”‚
â”‚             â”‚                               â”‚
â”‚ [Avatar]    â”‚  [Active Section Content]    â”‚
â”‚ Name        â”‚                               â”‚
â”‚             â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚ Navigation: â”‚  â”‚ Profile Header   â”‚        â”‚
â”‚ â€¢ Personal  â”‚  â”‚ [Avatar] Name    â”‚        â”‚
â”‚ â€¢ Stats     â”‚  â”‚ Role Badge       â”‚        â”‚
â”‚ â€¢ Prefs     â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚ â€¢ Security  â”‚                               â”‚
â”‚             â”‚  [Form/Content Area]          â”‚
â”‚ Quick Stats â”‚                               â”‚
â”‚ ğŸ”¥ 15 days  â”‚  [Save Button]               â”‚
â”‚ ğŸ“š 234 wordsâ”‚                               â”‚
â”‚ â­ 1,250 XP â”‚                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Mobile Layout (<768px)
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â˜° Profile       â”‚ <- Hamburger menu
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [Avatar]        â”‚
â”‚ Name            â”‚
â”‚ role@email.com  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [Tab Bar]       â”‚ <- Horizontal tabs
â”‚ Info|Stats|Pref â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                 â”‚
â”‚ [Section        â”‚
â”‚  Content]       â”‚
â”‚                 â”‚
â”‚ [Save Button]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Testing Scenarios

### Manual Testing Checklist

#### Profile Display Tests
- [ ] Login as demo@example.com
- [ ] Verify avatar shows initials "JD"
- [ ] Confirm Premium role badge is purple
- [ ] Check 15-day streak displays with flame icon
- [ ] Verify 234 words learned shows correctly
- [ ] Confirm 1,250 XP displays with Level 1

#### Profile Edit Tests
- [ ] Click edit button on Personal Info
- [ ] Change name to "John Demo Updated"
- [ ] Verify email field is read-only
- [ ] Click avatar upload (verify placeholder message)
- [ ] Save changes and verify success toast
- [ ] Refresh page and confirm persistence

#### Preferences Tests
- [ ] Change language from English to Greek
- [ ] Adjust daily goal slider to 30 minutes
- [ ] Toggle notifications off
- [ ] Verify auto-save with success feedback
- [ ] Check preferences persist after logout/login

#### Responsive Tests
- [ ] Test on desktop (1440px) - sidebar visible
- [ ] Test on tablet (768px) - sidebar collapses
- [ ] Test on mobile (375px) - hamburger menu
- [ ] Verify touch interactions on mobile
- [ ] Check form usability on small screens

#### Navigation Tests
- [ ] Click through all sidebar sections
- [ ] Verify active section highlighting
- [ ] Test keyboard navigation (Tab, Enter)
- [ ] Check back button behavior
- [ ] Verify URL updates (if using sub-routes)

#### Error Handling Tests
- [ ] Submit invalid name (1 character)
- [ ] Try setting daily goal to 200 minutes
- [ ] Test network error simulation
- [ ] Verify error messages are clear
- [ ] Check form validation messages

---

## Success Criteria

### Functional Requirements
- [ ] **Profile Information Display**: User can view their name, email, avatar, and role badge
- [ ] **Profile Editing**: User can update display name with validation and persistence
- [ ] **Learning Statistics**: Streak, words learned, XP, and level displayed prominently
- [ ] **Preferences Management**: Language, daily goal, and notifications customizable with auto-save
- [ ] **Security Section**: Password form validates correctly with appropriate "coming soon" messages
- [ ] **Navigation**: Seamless switching between sections on desktop and mobile

### Technical Requirements
- [ ] No TypeScript errors (strict mode)
- [ ] No ESLint warnings
- [ ] No 'any' types used
- [ ] All props properly typed
- [ ] Build verification successful

### Quality Requirements
- [ ] Page loads in <500ms
- [ ] Form interactions feel instant
- [ ] No unnecessary re-renders
- [ ] Smooth animations/transitions
- [ ] All forms keyboard navigable
- [ ] ARIA labels on all controls
- [ ] Focus states clearly visible
- [ ] Screen reader compatible

---

## Mock Data Strategy

### Using Existing Test Users
```typescript
// Available test accounts from mockAuthAPI:
// 1. demo@example.com (Premium user, 15-day streak)
// 2. admin@example.com (Admin user, 30-day streak)
// 3. free@example.com (Free user, 3-day streak)
```

### Optimistic Updates
```typescript
const handleProfileUpdate = async (data: ProfileFormData) => {
  // Optimistically update UI
  setIsLoading(true);

  try {
    // Update store (mock delay for realism)
    await updateProfile({ name: data.name });
    toast.success('Profile updated successfully!');
  } catch (error) {
    toast.error('Failed to update profile');
    // Revert optimistic update
  } finally {
    setIsLoading(false);
  }
};
```

### Simulated Features
1. **Avatar Upload**: Show file picker, display "Feature coming soon!" message
2. **Password Change**: Validate form, show "Password update will be available soon"
3. **Account Deletion**: Show confirmation dialog, then "Please contact support to delete account"
4. **Achievements**: Display 3-4 static badge placeholders with Greek-themed icons

---

## Route Configuration

### Update App.tsx
```typescript
// Add to imports
import Profile from '@/pages/Profile';

// Add to routes (inside ProtectedRoute wrapper)
<Route
  path="/profile"
  element={
    <ProtectedRoute>
      <Profile />
    </ProtectedRoute>
  }
/>
```

### Navigation Link Update
```typescript
// Add profile link to user menu in Header component
<Link to="/profile" className="menu-item">
  <User className="w-4 h-4 mr-2" />
  Profile
</Link>
```

---

## Installation Requirements

```bash
# Install required Shadcn components if missing:
npx shadcn-ui@latest add tabs
npx shadcn-ui@latest add slider
npx shadcn-ui@latest add progress
npx shadcn-ui@latest add dialog

# Install lodash for debounce functionality
npm install lodash @types/lodash
```

---

## Implementation Notes

### Design Rationale
1. **Two-column layout**: Provides clear navigation while maximizing content space
2. **Sidebar navigation**: Familiar pattern that scales well from desktop to mobile
3. **Auto-save preferences**: Reduces friction and prevents data loss
4. **Optimistic updates**: Makes the app feel fast and responsive
5. **Greek-themed elements**: Subtle touches (icons, colors) maintain cultural connection

### Technical Decisions
1. **Zustand for state**: Already integrated, provides simple API
2. **React Hook Form**: Reduces boilerplate, excellent validation
3. **Zod validation**: Type-safe schemas, good DX
4. **Shadcn components**: Consistent design, accessibility built-in
5. **No routing library for sections**: Simpler state-based switching

### Potential Improvements (Future)
1. Add real avatar upload with Cloudinary/S3
2. Implement actual password change with backend
3. Add more detailed statistics with charts
4. Create achievement system with unlockable badges
5. Add data export functionality
6. Implement theme switching (dark mode)

---

**Created**: 2025-10-29
**Last Updated**: 2025-10-29
**Task**: 03.06 - Create User Profile Page
**Estimated Time**: 75 minutes