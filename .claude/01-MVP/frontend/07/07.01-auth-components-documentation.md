# Task 07.01: Document Authentication Components

**Status**: üìã **PLANNED**
**Parent Task**: [Task 07 - UI Components](../07-ui-components.md)
**Priority**: High
**Estimated Duration**: 60 minutes
**Dependencies**: None
**Deliverable**: Updated Components-Reference.md with 6 documented auth components

---

## Objective

Document all 6 authentication-related components in the Components-Reference.md guide, providing complete TypeScript interfaces, usage examples, props documentation, and integration patterns.

---

## Components to Document

### 1. ProtectedRoute
**File**: `/src/components/auth/ProtectedRoute.tsx`
**Purpose**: Route guard that redirects unauthenticated users to login page
**Usage**: Wrap protected pages/routes that require authentication
**Key Props**: `children`, `redirectTo`

### 2. PublicRoute
**File**: `/src/components/auth/PublicRoute.tsx`
**Purpose**: Route guard that redirects authenticated users away from public pages (login/register)
**Usage**: Wrap auth pages (login, register) to prevent authenticated users from accessing them
**Key Props**: `children`, `redirectTo`

### 3. RouteGuard
**File**: `/src/components/auth/RouteGuard.tsx`
**Purpose**: Base route protection component with conditional rendering logic
**Usage**: Internal component used by ProtectedRoute and PublicRoute
**Key Props**: `condition`, `redirectTo`, `fallback`, `children`

### 4. AuthLayout
**File**: `/src/components/auth/AuthLayout.tsx`
**Purpose**: Layout wrapper for authentication pages (login, register, forgot password)
**Usage**: Provides consistent styling and structure for auth pages
**Key Props**: `children`, `title`, `subtitle`

### 5. LogoutDialog
**File**: `/src/components/auth/LogoutDialog.tsx`
**Purpose**: Confirmation dialog for logout action
**Usage**: Displayed when user clicks logout, confirms intent before logging out
**Key Props**: `open`, `onClose`, `onConfirm`

### 6. SessionWarningDialog
**File**: `/src/components/auth/SessionWarningDialog.tsx`
**Purpose**: Warning dialog shown before session expiration
**Usage**: Alerts user when session is about to expire, allows session extension
**Key Props**: `open`, `onClose`, `onExtend`, `timeRemaining`

---

## Documentation Template for Each Component

Each component should follow this structure in Components-Reference.md:

```markdown
### ComponentName

**Purpose**: [1-2 sentence description of what the component does and when to use it]

**File**: `/src/components/[category]/ComponentName.tsx`

**Interface**:
```typescript
interface ComponentNameProps {
  // All props with types and JSDoc comments
  propName: PropType;
  optionalProp?: OptionalType;
  callback?: (param: ParamType) => void;
}
```

**Usage**:
```tsx
import { ComponentName } from '@/components/[category]/ComponentName';

// Basic usage example
<ComponentName propName="value" />

// Advanced usage with optional props
<ComponentName
  propName="value"
  optionalProp="optional"
  callback={(param) => console.log(param)}
/>
```

**Props**:
| Prop | Type | Required | Default | Description |
|------|------|----------|---------|-------------|
| propName | PropType | Yes | - | Description of prop |
| optionalProp | OptionalType | No | undefined | Description of optional prop |

**States/Variants** (if applicable):
- Loading state
- Error state
- Success state

**Related Components**:
- [OtherComponent](#othercomponent) - How they relate

**Integration Notes**:
- Key implementation details
- Common patterns or pitfalls
- Authentication flow specifics

**Example**:
```tsx
// Real-world usage example from the application
```
```

---

## Implementation Steps

### Step 1: Read Component Source Code (15 min)

For each component, analyze:
1. TypeScript interface definitions
2. Component props and default values
3. Internal state management
4. Integration with `useAuth` hook or auth store
5. Conditional rendering logic
6. Error handling patterns

```bash
# Read all auth component files
cat /src/components/auth/ProtectedRoute.tsx
cat /src/components/auth/PublicRoute.tsx
cat /src/components/auth/RouteGuard.tsx
cat /src/components/auth/AuthLayout.tsx
cat /src/components/auth/LogoutDialog.tsx
cat /src/components/auth/SessionWarningDialog.tsx
```

### Step 2: Extract TypeScript Interfaces (10 min)

Create accurate TypeScript definitions:
- Extract existing prop interfaces
- Add JSDoc comments for clarity
- Document all required vs optional props
- Include callback function signatures
- Note any generic types or advanced patterns

### Step 3: Create Usage Examples (20 min)

For each component, write 2-3 usage examples:

**Basic Example**:
```tsx
// Simplest possible usage
<ProtectedRoute>
  <Dashboard />
</ProtectedRoute>
```

**Advanced Example**:
```tsx
// With all optional props and customization
<ProtectedRoute redirectTo="/login">
  <Settings />
</ProtectedRoute>
```

**Real-World Example**:
```tsx
// Actual usage from App.tsx or route configuration
<Routes>
  <Route path="/dashboard" element={
    <ProtectedRoute>
      <Dashboard />
    </ProtectedRoute>
  } />
</Routes>
```

### Step 4: Document Integration Patterns (10 min)

Add "Authentication Patterns" section to Components-Reference.md:

```markdown
## Authentication Patterns

### Route Protection Pattern

All authenticated routes follow this pattern:

```tsx
// App.tsx or route configuration
import { ProtectedRoute } from '@/components/auth/ProtectedRoute';

<Route path="/dashboard" element={
  <ProtectedRoute>
    <Dashboard />
  </ProtectedRoute>
} />
```

### Public Route Pattern

Authentication pages (login, register) use PublicRoute to prevent authenticated users from accessing:

```tsx
<Route path="/login" element={
  <PublicRoute redirectTo="/dashboard">
    <Login />
  </PublicRoute>
} />
```

### Session Management Pattern

SessionWarningDialog integration with auth store:

```tsx
// In AppLayout or App.tsx
const { sessionExpiresAt, extendSession } = useAuth();
const [showWarning, setShowWarning] = useState(false);

useEffect(() => {
  // Check if session expires in less than 5 minutes
  const checkInterval = setInterval(() => {
    const timeRemaining = sessionExpiresAt - Date.now();
    if (timeRemaining < 5 * 60 * 1000 && timeRemaining > 0) {
      setShowWarning(true);
    }
  }, 60000); // Check every minute

  return () => clearInterval(checkInterval);
}, [sessionExpiresAt]);

<SessionWarningDialog
  open={showWarning}
  onClose={() => setShowWarning(false)}
  onExtend={extendSession}
  timeRemaining={Math.floor((sessionExpiresAt - Date.now()) / 1000)}
/>
```
```

### Step 5: Update Components-Reference.md (5 min)

Add new "Authentication Components" section in appropriate location:

**Suggested Location**: After "Navigation Components" section, before "Layout Components"

**Section Structure**:
```markdown
### Authentication Components (6)
Components for user authentication, route protection, and session management

| Component | Type | Purpose |
|-----------|------|---------|
| [ProtectedRoute](#protectedroute) | Route Guard | Protects authenticated routes |
| [PublicRoute](#publicroute) | Route Guard | Protects public auth pages |
| [RouteGuard](#routeguard) | Base Guard | Base route protection logic |
| [AuthLayout](#authlayout) | Layout | Auth page wrapper |
| [LogoutDialog](#logoutdialog) | Dialog | Logout confirmation |
| [SessionWarningDialog](#sessionwarningdialog) | Dialog | Session expiration warning |
```

Then add each component's full documentation in the detailed sections.

---

## Success Criteria

- [ ] All 6 auth components have complete TypeScript interfaces documented
- [ ] Each component has 2-3 practical usage examples
- [ ] Props tables are complete with all required/optional props
- [ ] "Authentication Patterns" section added to Components-Reference.md
- [ ] Integration examples show real-world usage with React Router
- [ ] Session management pattern documented with useAuth hook integration
- [ ] All code examples use correct import paths (@/components/...)
- [ ] Cross-references to useAuth hook and auth store are included
- [ ] Documentation follows consistent formatting with existing entries
- [ ] No TypeScript syntax errors in code examples

---

## File Paths Reference

All file paths for documentation:

```
Source Files:
/Users/samosipov/Downloads/learn-greek-easy/learn-greek-easy-frontend/src/components/auth/ProtectedRoute.tsx
/Users/samosipov/Downloads/learn-greek-easy/learn-greek-easy-frontend/src/components/auth/PublicRoute.tsx
/Users/samosipov/Downloads/learn-greek-easy/learn-greek-easy-frontend/src/components/auth/RouteGuard.tsx
/Users/samosipov/Downloads/learn-greek-easy/learn-greek-easy-frontend/src/components/auth/AuthLayout.tsx
/Users/samosipov/Downloads/learn-greek-easy/learn-greek-easy-frontend/src/components/auth/LogoutDialog.tsx
/Users/samosipov/Downloads/learn-greek-easy/learn-greek-easy-frontend/src/components/auth/SessionWarningDialog.tsx

Documentation File:
/Users/samosipov/Downloads/learn-greek-easy/.claude/01-MVP/frontend/Components-Reference.md

Related Files:
/Users/samosipov/Downloads/learn-greek-easy/learn-greek-easy-frontend/src/hooks/useAuth.ts
/Users/samosipov/Downloads/learn-greek-easy/learn-greek-easy-frontend/src/store/authStore.ts
```

---

## Integration Notes

### Authentication Flow

The auth components work together to create secure authentication flow:

1. **Initial Page Load**:
   - RouteGuard checks authentication status via useAuth hook
   - ProtectedRoute redirects to /login if not authenticated
   - PublicRoute redirects to /dashboard if already authenticated

2. **Session Management**:
   - SessionWarningDialog monitors session expiration
   - Shows warning 5 minutes before expiration
   - Allows user to extend session or lets it expire

3. **Logout Flow**:
   - User clicks logout in UserMenu
   - LogoutDialog appears for confirmation
   - On confirm, calls authStore.logout()
   - User redirected to /login via ProtectedRoute

### Auth Store Integration

All auth components rely on the auth store (Zustand):

```typescript
// Typical usage in auth components
import { useAuthStore } from '@/store/authStore';

const { isAuthenticated, user, logout, extendSession } = useAuthStore();
```

### React Router Integration

Auth components are designed to work with React Router v6:

```tsx
// In App.tsx
import { BrowserRouter, Routes, Route } from 'react-router-dom';
import { ProtectedRoute } from '@/components/auth/ProtectedRoute';

<BrowserRouter>
  <Routes>
    <Route path="/" element={<ProtectedRoute><Dashboard /></ProtectedRoute>} />
    <Route path="/login" element={<PublicRoute><Login /></PublicRoute>} />
  </Routes>
</BrowserRouter>
```

---

## Common Pitfalls to Document

1. **Nested ProtectedRoute**: Don't nest ProtectedRoute components
   ```tsx
   // ‚ùå Wrong - unnecessary nesting
   <ProtectedRoute>
     <ProtectedRoute>
       <Dashboard />
     </ProtectedRoute>
   </ProtectedRoute>

   // ‚úÖ Correct - single wrapper
   <ProtectedRoute>
     <Dashboard />
   </ProtectedRoute>
   ```

2. **PublicRoute on Protected Pages**: Don't use PublicRoute on pages that require auth
   ```tsx
   // ‚ùå Wrong - PublicRoute on protected page
   <Route path="/dashboard" element={
     <PublicRoute><Dashboard /></PublicRoute>
   } />

   // ‚úÖ Correct - ProtectedRoute on protected page
   <Route path="/dashboard" element={
     <ProtectedRoute><Dashboard /></ProtectedRoute>
   } />
   ```

3. **Missing redirectTo Prop**: Always specify where to redirect
   ```tsx
   // ‚ö†Ô∏è Caution - uses default redirect
   <ProtectedRoute>
     <Dashboard />
   </ProtectedRoute>

   // ‚úÖ Better - explicit redirect
   <ProtectedRoute redirectTo="/login">
     <Dashboard />
   </ProtectedRoute>
   ```

---

## Related Style Guide Updates

This task documents components. The corresponding pattern documentation is in Task 07.04b (Protected Route Patterns).

Ensure cross-references are added:
- Components-Reference.md ‚Üí Link to Style Guide Protected Route Patterns
- Style-Guide.md ‚Üí Link to Components-Reference.md auth components

---

## Definition of Done

- [ ] Components-Reference.md updated with "Authentication Components" section
- [ ] All 6 components fully documented with interfaces, usage, props
- [ ] "Authentication Patterns" section added with integration examples
- [ ] All code examples tested and verified syntactically correct
- [ ] Cross-references added to useAuth hook and auth store
- [ ] Common pitfalls documented
- [ ] Documentation formatting consistent with existing entries
- [ ] File paths verified and correct
- [ ] Task completion logged in Frontend-Tasks-Progress.md

---

## Time Breakdown

| Activity | Duration | Details |
|----------|----------|---------|
| Read component source code | 15 min | Analyze all 6 components |
| Extract TypeScript interfaces | 10 min | Create accurate prop definitions |
| Create usage examples | 20 min | Write 2-3 examples per component |
| Document integration patterns | 10 min | Auth flow, session management |
| Update Components-Reference.md | 5 min | Add section and format |
| **TOTAL** | **60 min** | |

---

## Next Steps

After completing this task:
1. Proceed to Task 07.02 (Layout Components Documentation)
2. Cross-reference with Task 07.04b (Protected Route Patterns in Style Guide)
3. Consider adding screenshots of SessionWarningDialog and LogoutDialog
