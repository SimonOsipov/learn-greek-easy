# Task 08.02: App Preferences Section

**Status**: ✅ **COMPLETED**
**Completed**: 2025-11-06
**Duration**: 30 minutes
**Dependencies**: Task 08.01 (Account Settings Section - COMPLETED)
**Created**: 2025-11-06
**File**: [08.02-app-preferences-section.md](./08.02-app-preferences-section.md)

---

## Overview

### Description

Create the **AppPreferencesSection** component for the Settings page that provides a streamlined preferences management interface focused on the daily study goal. This simplified MVP version includes only the essential daily goal slider with auto-save functionality, removing complex preference options (notifications, language, theme) that are deferred to post-MVP.

### Why It's Important

User preferences directly impact learning experience and engagement. The daily study goal setting allows users to:
- Set personalized learning targets aligned with their schedule
- Track progress against their own defined goals
- Build sustainable learning habits

This section complements the AccountSection by shifting focus from account credentials to learning behavior customization. The auto-save pattern provides a frictionless UX that encourages experimentation without fear of losing changes.

### Success Criteria

1. **Daily Goal Slider**:
   - Range: 5-100 cards, step size: 5 cards
   - Default value: 20 cards per day
   - Live value preview displays "X cards per day"
   - Slider is keyboard accessible (arrow keys work)
   - Mobile-friendly touch interactions

2. **Auto-Save Functionality**:
   - Changes auto-save 1 second after user stops adjusting slider (debounce)
   - Success toast notification appears after save
   - No manual save button required
   - Loading state indication during save (optional subtle indicator)
   - Preferences persist in localStorage via authStore

3. **Visual Design**:
   - Matches AccountSection Card layout and styling
   - Section header: "App Preferences" with icon
   - Clean, minimal UI with clear labels
   - Consistent spacing and typography

4. **Technical Requirements**:
   - TypeScript: 0 compilation errors
   - Build: SUCCESS with no warnings
   - Mobile responsive (375px - 1440px+)
   - Integrates with existing authStore patterns
   - Uses Shadcn/ui Slider component

---

## Component Design

### AppPreferencesSection Component Structure

**File**: `/Users/samosipov/Downloads/learn-greek-easy/learn-greek-easy-frontend/src/components/settings/AppPreferencesSection.tsx`

**Component Architecture**:
```
AppPreferencesSection
└── Card Container
    ├── CardHeader
    │   ├── CardTitle: "App Preferences"
    │   └── CardDescription: "Customize your learning experience"
    │
    └── CardContent
        └── Daily Goal Setting
            ├── Settings icon + "Daily Study Goal" label
            ├── Description: "Number of new cards to review each day"
            ├── Slider component (5-100, step 5)
            ├── Value display: "20 cards per day"
            └── Auto-save with debounce (no visible save button)
```

### TypeScript Interfaces

**File**: `/Users/samosipov/Downloads/learn-greek-easy/learn-greek-easy-frontend/src/types/auth.ts` (UPDATE EXISTING)

**Update UserPreferences interface**:
```typescript
// User preferences
export interface UserPreferences {
  language: 'en' | 'el';
  dailyGoal: number; // cards per day (5-100)
  notifications: boolean;
  theme?: 'light' | 'dark';
}
```

**Note**: The `UserPreferences` interface already exists with `dailyGoal` defined as "minutes". We need to clarify the unit. For Task 08.02, we'll interpret `dailyGoal` as **cards per day** (5-100 range). If the existing implementation uses minutes, we'll need to update the interface documentation to specify cards.

**Actual implementation decision**: Based on the existing `auth.ts`, `dailyGoal` is defined as minutes. For MVP simplification and consistency with the task requirements, we'll **reinterpret** this field as **cards per day** in the Settings UI. The authStore will store the numeric value, and the UI will treat it as cards. This avoids type changes and maintains compatibility.

### Daily Goal Slider Specification

**Component**: Slider (from Shadcn/ui)

**Configuration**:
```typescript
<Slider
  min={5}
  max={100}
  step={5}
  value={[dailyGoal]}
  onValueChange={(value) => setDailyGoal(value[0])}
  className="w-full"
  aria-label="Daily study goal"
/>
```

**Value Display**:
- Format: `{dailyGoal} cards per day`
- Example: "20 cards per day"
- Styling: Medium font weight, visible above or below slider
- Updates in real-time as slider moves

**Auto-Save Pattern**:
```typescript
const [dailyGoal, setDailyGoal] = useState(user?.preferences?.dailyGoal || 20);
const [isSaving, setIsSaving] = useState(false);

useEffect(() => {
  const timer = setTimeout(() => {
    if (dailyGoal !== user?.preferences?.dailyGoal) {
      setIsSaving(true);
      updatePreferences({ dailyGoal })
        .then(() => {
          toast.success('Daily goal updated');
          setIsSaving(false);
        })
        .catch((error) => {
          toast.error('Failed to save preferences');
          setIsSaving(false);
        });
    }
  }, 1000); // 1 second debounce

  return () => clearTimeout(timer);
}, [dailyGoal]);
```

---

## Implementation Steps

### Step 1: Check and Install Slider Component (2 min)

**Action**: Verify if Slider component is installed; install if missing

**Check Command**:
```bash
ls /Users/samosipov/Downloads/learn-greek-easy/learn-greek-easy-frontend/src/components/ui/slider.tsx
```

**Install Command** (if not found):
```bash
cd /Users/samosipov/Downloads/learn-greek-easy/learn-greek-easy-frontend && npx shadcn-ui@latest add slider
```

**Verification**: Slider component exists at `src/components/ui/slider.tsx`

---

### Step 2: Update authStore with updatePreferences Method (5 min)

**Action**: Add `updatePreferences` method to authStore if not already present

**File**: `/Users/samosipov/Downloads/learn-greek-easy/learn-greek-easy-frontend/src/stores/authStore.ts`

**Check if method exists**: Look for `updatePreferences` in AuthState interface

**If missing, add to AuthState interface**:
```typescript
interface AuthState {
  // ... existing properties
  updatePreferences: (preferences: Partial<UserPreferences>) => Promise<void>;
}
```

**If missing, add to store implementation** (after `updateProfile` method):
```typescript
// Update preferences action
updatePreferences: async (preferences: Partial<UserPreferences>) => {
  const { user } = get();

  if (!user) {
    throw new Error('No user logged in');
  }

  set({ isLoading: true, error: null });

  try {
    // Merge new preferences with existing ones
    const updatedPreferences = {
      ...user.preferences,
      ...preferences,
    };

    // Call updateProfile with preferences update
    const updatedUser = await mockAuthAPI.updateProfile(user.id, {
      preferences: updatedPreferences,
    });

    set({
      user: updatedUser,
      isLoading: false,
      error: null,
    });
  } catch (error) {
    set({
      isLoading: false,
      error: error as AuthError,
    });
    throw error;
  }
},
```

**Alternative approach**: If `updateProfile` already accepts `preferences` as a field, we can skip adding `updatePreferences` and use `updateProfile({ preferences })` directly from the component.

**Decision**: Use `updateProfile({ preferences: { ...user.preferences, dailyGoal } })` pattern to avoid adding another store method. This keeps the authStore interface consistent with AccountSection.

---

### Step 3: Create AppPreferencesSection Component Shell (3 min)

**Action**: Create component file with basic structure

**File**: `/Users/samosipov/Downloads/learn-greek-easy/learn-greek-easy-frontend/src/components/settings/AppPreferencesSection.tsx`

**Initial Content**:
```typescript
import React, { useState, useEffect } from 'react';
import { Settings } from 'lucide-react';

import { useAuthStore } from '@/stores/authStore';
import { useToast } from '@/hooks/use-toast';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Slider } from '@/components/ui/slider';

/**
 * AppPreferencesSection Component
 *
 * Provides app preference management focused on daily study goal:
 * - Daily goal slider (5-100 cards, step 5)
 * - Auto-save with 1-second debounce
 * - Live value preview
 *
 * Integrates with authStore for persistence.
 */
export function AppPreferencesSection() {
  const { user, updateProfile } = useAuthStore();
  const { toast } = useToast();

  if (!user) {
    return null; // Should not happen (Settings page requires auth)
  }

  return (
    <Card>
      <CardHeader>
        <CardTitle>App Preferences</CardTitle>
        <CardDescription>
          Customize your learning experience
        </CardDescription>
      </CardHeader>
      <CardContent className="space-y-6">
        {/* TODO: Daily Goal Slider */}
      </CardContent>
    </Card>
  );
}
```

**Verification**: Component renders without errors when imported into Settings.tsx

---

### Step 4: Implement Daily Goal Slider with Live Preview (10 min)

**Action**: Add slider with real-time value display

**Code Addition** (within CardContent):
```typescript
// State for slider value
const [dailyGoal, setDailyGoal] = useState(user?.preferences?.dailyGoal || 20);

// ... (in JSX, replace TODO comment)

{/* Daily Goal Section */}
<div className="space-y-4">
  <div className="flex items-center gap-2">
    <Settings className="h-4 w-4 text-muted-foreground" />
    <h3 className="font-medium">Daily Study Goal</h3>
  </div>

  <div className="p-4 bg-muted/50 rounded-lg space-y-4">
    <div>
      <p className="text-sm text-muted-foreground mb-4">
        Number of new cards to review each day
      </p>

      <Slider
        min={5}
        max={100}
        step={5}
        value={[dailyGoal]}
        onValueChange={(value) => setDailyGoal(value[0])}
        className="w-full"
        aria-label="Daily study goal slider"
      />
    </div>

    <div className="flex items-center justify-between">
      <span className="text-sm text-muted-foreground">Goal:</span>
      <span className="text-lg font-semibold text-foreground">
        {dailyGoal} cards per day
      </span>
    </div>
  </div>
</div>
```

**Styling Notes**:
- Background: `bg-muted/50` (matches AccountSection pattern)
- Padding: `p-4` for content container
- Spacing: `space-y-4` between elements
- Value display: Large, bold text for emphasis

**Verification**:
- Slider moves smoothly from 5 to 100
- Value display updates in real-time
- Slider works with mouse, touch, and keyboard (arrow keys)

---

### Step 5: Implement Auto-Save with Debounce (7 min)

**Action**: Add debounced auto-save functionality

**Code Addition** (within component, after useState):
```typescript
const [dailyGoal, setDailyGoal] = useState(user?.preferences?.dailyGoal || 20);
const [isSaving, setIsSaving] = useState(false);

useEffect(() => {
  // Don't save on initial mount (when value equals current user preference)
  if (dailyGoal === user?.preferences?.dailyGoal) {
    return;
  }

  // Debounce: wait 1 second after last change
  const timer = setTimeout(async () => {
    setIsSaving(true);

    try {
      await updateProfile({
        preferences: {
          ...user.preferences,
          dailyGoal,
        },
      });

      toast({
        title: 'Preferences saved',
        description: `Daily goal set to ${dailyGoal} cards per day`,
      });
    } catch (error) {
      toast({
        title: 'Failed to save preferences',
        description: error instanceof Error ? error.message : 'An error occurred',
        variant: 'destructive',
      });
    } finally {
      setIsSaving(false);
    }
  }, 1000);

  return () => clearTimeout(timer);
}, [dailyGoal, user?.preferences, updateProfile, toast]);
```

**Optional: Add Saving Indicator** (subtle feedback):
```typescript
// Add to value display section:
<div className="flex items-center justify-between">
  <span className="text-sm text-muted-foreground">Goal:</span>
  <div className="flex items-center gap-2">
    <span className="text-lg font-semibold text-foreground">
      {dailyGoal} cards per day
    </span>
    {isSaving && (
      <Loader2 className="h-4 w-4 animate-spin text-muted-foreground" />
    )}
  </div>
</div>
```

**Import Loader2** (if using saving indicator):
```typescript
import { Settings, Loader2 } from 'lucide-react';
```

**Verification**:
- Move slider → Wait 1 second → Toast appears
- Move slider multiple times rapidly → Only one save after stopping
- Toast shows correct daily goal value
- Preference persists after page refresh

---

### Step 6: Update index.ts Barrel Export (1 min)

**Action**: Add AppPreferencesSection to settings components export

**File**: `/Users/samosipov/Downloads/learn-greek-easy/learn-greek-easy-frontend/src/components/settings/index.ts`

**Update Content**:
```typescript
export { AccountSection } from './AccountSection';
export { AppPreferencesSection } from './AppPreferencesSection';
// Future exports:
// export { DangerZoneSection } from './DangerZoneSection';
```

**Verification**: Import works: `import { AppPreferencesSection } from '@/components/settings';`

---

### Step 7: Integrate into Settings Page (2 min)

**Action**: Add AppPreferencesSection to Settings page

**File**: `/Users/samosipov/Downloads/learn-greek-easy/learn-greek-easy-frontend/src/pages/Settings.tsx`

**Update Content**:
```typescript
import React from 'react';
import { AccountSection, AppPreferencesSection } from '@/components/settings';

const Settings: React.FC = () => {
  return (
    <div className="container mx-auto px-4 py-6 max-w-4xl">
      <div className="mb-6">
        <h1 className="text-3xl font-bold">Settings</h1>
        <p className="mt-2 text-muted-foreground">Manage your account and preferences.</p>
      </div>

      <div className="space-y-6">
        <AccountSection />
        <AppPreferencesSection />
        {/* TODO: Add DangerZoneSection (Task 08.03) */}
      </div>
    </div>
  );
};

export default Settings;
```

**Verification**: Navigate to `/settings` page and verify AppPreferencesSection renders below AccountSection

---

### Step 8: Test Auto-Save Functionality (3 min)

**Testing Steps**:
1. Navigate to Settings page (`/settings`)
2. Adjust daily goal slider to 50 cards
3. Wait 1 second → Success toast should appear
4. Check localStorage:
   ```javascript
   JSON.parse(localStorage.getItem('auth-storage')).state.user.preferences.dailyGoal
   // Should equal 50
   ```
5. Refresh page → Slider should remain at 50 cards
6. Rapidly move slider multiple times → Only one toast after stopping
7. Move slider to original value (20) → Should save and show toast

**Expected Results**:
- Auto-save triggers exactly 1 second after last slider movement
- Toast notification displays with correct value
- Preference persists across page refreshes
- No duplicate save requests

---

### Step 9: Test Responsive Behavior (2 min)

**Testing Steps**:
1. Test at 375px width (iPhone SE):
   - Slider should be full-width
   - Value display should remain readable
   - Touch interactions should work smoothly

2. Test at 768px width (iPad):
   - Layout should adapt naturally
   - No excessive whitespace

3. Test at 1024px+ width (Desktop):
   - Slider should not stretch excessively (container max-width applies)
   - Value display remains aligned

**Expected Results**:
- No horizontal scroll at any breakpoint
- Slider thumb is tappable on mobile (sufficient touch target)
- Text remains readable at all sizes

---

### Step 10: Update Documentation (3 min)

**Action**: Update settings-components.md with AppPreferencesSection

**File**: `/Users/samosipov/Downloads/learn-greek-easy/learn-greek-easy-frontend/docs/components/settings-components.md`

**Add after AccountSection**:
```markdown
### AppPreferencesSection

**Purpose**: App preferences management section providing daily study goal customization with auto-save functionality.

**Location**: `/src/components/settings/AppPreferencesSection.tsx`

**Interface**:
```typescript
// No props - uses global auth context from useAuthStore
```

**Usage**:
```tsx
import { AppPreferencesSection } from '@/components/settings/AppPreferencesSection';

// In Settings page
<AppPreferencesSection />
```

**Features**:
- Daily study goal slider (5-100 cards, step 5)
- Live value preview ("X cards per day")
- Auto-save with 1-second debounce (no manual save button)
- Success toast notification on save
- Preferences persist in localStorage via authStore
- Optional saving indicator (spinner)

**Visual Structure**:

1. **Daily Study Goal Setting**:
   - Settings icon header
   - Description: "Number of new cards to review each day"
   - Slider component (min: 5, max: 100, step: 5)
   - Value display: "{dailyGoal} cards per day" (live update)
   - Auto-save triggers 1 second after last change

**Auto-Save Pattern**:
```typescript
useEffect(() => {
  if (dailyGoal === user?.preferences?.dailyGoal) {
    return; // Skip save if value unchanged
  }

  const timer = setTimeout(async () => {
    await updateProfile({
      preferences: { ...user.preferences, dailyGoal },
    });
    toast({ title: 'Preferences saved' });
  }, 1000);

  return () => clearTimeout(timer);
}, [dailyGoal]);
```

**Integration**:
- Uses `useAuthStore` for user data and update method:
  - `user.preferences.dailyGoal` - Current daily goal value (default: 20)
  - `updateProfile({ preferences })` - Update preferences
- Uses `Slider` component from shadcn/ui
- Uses `toast` from shadcn/ui for notifications
- Uses `lucide-react` Settings icon

**Debounce Logic**:
- User adjusts slider → State updates immediately (live preview)
- Timer starts (1000ms)
- If user adjusts again → Timer resets
- After 1 second of inactivity → Auto-save triggers
- Toast notification confirms save

**Error Handling**:
- Try-catch around updateProfile call
- Error toast displays with descriptive message
- Slider value remains at user-selected position (not reverted)

**Dependencies**:
- `@/stores/authStore` - User data and update method
- `@/hooks/use-toast` - Toast notifications
- `@/components/ui/slider` - Slider component (shadcn/ui)
- `@/components/ui/card` - Card container
- `lucide-react` - Settings icon

**Responsive Behavior**:
- Mobile (< 768px): Full-width slider, stacked layout
- Desktop (1024px+): Same layout (slider is inherently responsive)

**Accessibility**:
- Slider has `aria-label="Daily study goal slider"`
- Keyboard navigation: Arrow keys adjust value, Home/End for min/max
- Focus visible on slider thumb
- Value display provides immediate feedback for screen readers

---
```

**Verification**: Documentation is clear, accurate, and matches implementation

---

## UI/UX Specifications

### Layout and Structure

**Section Container**:
- Component: Card (shadcn/ui)
- Padding: Same as AccountSection (`p-6` / 24px)
- Spacing: `space-y-6` between sections

**Section Header**:
- Icon: Settings (lucide-react, 16px, `text-muted-foreground`)
- Text: "Daily Study Goal" (`font-medium`, 500 weight)
- Layout: Flex with gap-2

**Content Container**:
- Background: `bg-muted/50` (matches AccountSection pattern)
- Padding: `p-4` (16px)
- Border radius: `rounded-lg` (8px)
- Internal spacing: `space-y-4`

### Slider Styling

**Slider Component** (Shadcn/ui default):
- Track: Gray background, rounded
- Filled track: Primary color (purple)
- Thumb: Circle, primary color, 16px diameter
- Focus ring: Visible on keyboard focus
- Hover: Slightly larger thumb

**Range Values**:
- Minimum: 5 cards
- Maximum: 100 cards
- Step: 5 cards (user can only select multiples of 5)
- Default: 20 cards

### Value Display

**Typography**:
- Label: "Goal:" - Small, muted foreground
- Value: "{dailyGoal} cards per day" - Large (`text-lg`), bold (`font-semibold`), foreground color
- Layout: Flex with space-between alignment

**Optional Saving Indicator**:
- Spinner: Loader2 icon (lucide-react)
- Size: 16px (`h-4 w-4`)
- Color: Muted foreground
- Animation: `animate-spin` (Tailwind utility)
- Position: Next to value display

### Success/Error Messaging

**Success Toast** (useToast with default variant):
- Title: "Preferences saved"
- Description: "Daily goal set to {dailyGoal} cards per day"
- Duration: Auto-dismiss after 5 seconds

**Error Toast** (useToast with destructive variant):
- Title: "Failed to save preferences"
- Description: [Error message from authStore]
- Duration: Auto-dismiss after 5 seconds

### Responsive Breakpoints

**Mobile (< 768px)**:
- Single column layout
- Full-width slider
- Value display stacks if needed

**Tablet (768px - 1023px)**:
- Same as desktop (slider is inherently responsive)

**Desktop (1024px+)**:
- Container constrained by parent max-width (4xl)
- Slider expands to full container width

---

## Files to Create/Modify

### Files to Create

1. **`/Users/samosipov/Downloads/learn-greek-easy/learn-greek-easy-frontend/src/components/settings/AppPreferencesSection.tsx`**
   - **Purpose**: Main AppPreferencesSection component with daily goal slider and auto-save
   - **Estimated Lines**: ~80 lines (with optional saving indicator)
   - **Content**:
     - Component with daily goal slider
     - Auto-save with debounce (useEffect)
     - Toast notifications
     - Integration with authStore

### Files to Modify

2. **`/Users/samosipov/Downloads/learn-greek-easy/learn-greek-easy-frontend/src/components/settings/index.ts`**
   - **Modification**: Add AppPreferencesSection export
   - **Lines Added**: 1 line
   - **Purpose**: Enable barrel import from settings module

3. **`/Users/samosipov/Downloads/learn-greek-easy/learn-greek-easy-frontend/src/pages/Settings.tsx`**
   - **Modification**: Import and render AppPreferencesSection
   - **Lines Added**: ~2 lines (import + component usage)
   - **Purpose**: Integrate AppPreferencesSection into Settings page

4. **`/Users/samosipov/Downloads/learn-greek-easy/learn-greek-easy-frontend/docs/components/settings-components.md`**
   - **Modification**: Add AppPreferencesSection documentation
   - **Lines Added**: ~70 lines
   - **Purpose**: Document component usage and patterns

### Files to Check (May Need Installation)

5. **`/Users/samosipov/Downloads/learn-greek-easy/learn-greek-easy-frontend/src/components/ui/slider.tsx`**
   - **Check**: Does this file exist?
   - **If Not**: Run `npx shadcn-ui@latest add slider` to install

---

## Code Examples

### Example 1: Complete AppPreferencesSection Component

**File**: `src/components/settings/AppPreferencesSection.tsx`

```typescript
import React, { useState, useEffect } from 'react';
import { Settings, Loader2 } from 'lucide-react';

import { useAuthStore } from '@/stores/authStore';
import { useToast } from '@/hooks/use-toast';
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Slider } from '@/components/ui/slider';

/**
 * AppPreferencesSection Component
 *
 * Provides app preference management focused on daily study goal:
 * - Daily goal slider (5-100 cards, step 5)
 * - Auto-save with 1-second debounce
 * - Live value preview
 *
 * Integrates with authStore for persistence.
 */
export function AppPreferencesSection() {
  const { user, updateProfile } = useAuthStore();
  const { toast } = useToast();

  const [dailyGoal, setDailyGoal] = useState(user?.preferences?.dailyGoal || 20);
  const [isSaving, setIsSaving] = useState(false);

  // Auto-save with debounce
  useEffect(() => {
    // Don't save on initial mount or if value hasn't changed
    if (dailyGoal === user?.preferences?.dailyGoal) {
      return;
    }

    // Debounce: wait 1 second after last change
    const timer = setTimeout(async () => {
      setIsSaving(true);

      try {
        await updateProfile({
          preferences: {
            ...user.preferences,
            dailyGoal,
          },
        });

        toast({
          title: 'Preferences saved',
          description: `Daily goal set to ${dailyGoal} cards per day`,
        });
      } catch (error) {
        toast({
          title: 'Failed to save preferences',
          description: error instanceof Error ? error.message : 'An error occurred',
          variant: 'destructive',
        });
      } finally {
        setIsSaving(false);
      }
    }, 1000);

    return () => clearTimeout(timer);
  }, [dailyGoal, user?.preferences, updateProfile, toast]);

  if (!user) {
    return null; // Should not happen (Settings page requires auth)
  }

  return (
    <Card>
      <CardHeader>
        <CardTitle>App Preferences</CardTitle>
        <CardDescription>
          Customize your learning experience
        </CardDescription>
      </CardHeader>
      <CardContent className="space-y-6">
        {/* Daily Goal Section */}
        <div className="space-y-4">
          <div className="flex items-center gap-2">
            <Settings className="h-4 w-4 text-muted-foreground" />
            <h3 className="font-medium">Daily Study Goal</h3>
          </div>

          <div className="p-4 bg-muted/50 rounded-lg space-y-4">
            <div>
              <p className="text-sm text-muted-foreground mb-4">
                Number of new cards to review each day
              </p>

              <Slider
                min={5}
                max={100}
                step={5}
                value={[dailyGoal]}
                onValueChange={(value) => setDailyGoal(value[0])}
                className="w-full"
                aria-label="Daily study goal slider"
              />
            </div>

            <div className="flex items-center justify-between">
              <span className="text-sm text-muted-foreground">Goal:</span>
              <div className="flex items-center gap-2">
                <span className="text-lg font-semibold text-foreground">
                  {dailyGoal} cards per day
                </span>
                {isSaving && (
                  <Loader2 className="h-4 w-4 animate-spin text-muted-foreground" />
                )}
              </div>
            </div>
          </div>
        </div>
      </CardContent>
    </Card>
  );
}
```

---

### Example 2: Settings Page Integration

**File**: `src/pages/Settings.tsx`

```typescript
import React from 'react';
import { AccountSection, AppPreferencesSection } from '@/components/settings';

const Settings: React.FC = () => {
  return (
    <div className="container mx-auto px-4 py-6 max-w-4xl">
      <div className="mb-6">
        <h1 className="text-3xl font-bold">Settings</h1>
        <p className="mt-2 text-muted-foreground">Manage your account and preferences.</p>
      </div>

      <div className="space-y-6">
        <AccountSection />
        <AppPreferencesSection />
        {/* TODO: Add DangerZoneSection (Task 08.03) */}
      </div>
    </div>
  );
};

export default Settings;
```

---

### Example 3: Alternative Implementation (Without Saving Indicator)

**Simpler version without optional spinner**:

```typescript
export function AppPreferencesSection() {
  const { user, updateProfile } = useAuthStore();
  const { toast } = useToast();

  const [dailyGoal, setDailyGoal] = useState(user?.preferences?.dailyGoal || 20);

  // Auto-save with debounce
  useEffect(() => {
    if (dailyGoal === user?.preferences?.dailyGoal) {
      return;
    }

    const timer = setTimeout(async () => {
      try {
        await updateProfile({
          preferences: {
            ...user.preferences,
            dailyGoal,
          },
        });

        toast({
          title: 'Preferences saved',
          description: `Daily goal set to ${dailyGoal} cards per day`,
        });
      } catch (error) {
        toast({
          title: 'Failed to save preferences',
          description: error instanceof Error ? error.message : 'An error occurred',
          variant: 'destructive',
        });
      }
    }, 1000);

    return () => clearTimeout(timer);
  }, [dailyGoal, user?.preferences, updateProfile, toast]);

  if (!user) {
    return null;
  }

  return (
    <Card>
      <CardHeader>
        <CardTitle>App Preferences</CardTitle>
        <CardDescription>
          Customize your learning experience
        </CardDescription>
      </CardHeader>
      <CardContent className="space-y-6">
        <div className="space-y-4">
          <div className="flex items-center gap-2">
            <Settings className="h-4 w-4 text-muted-foreground" />
            <h3 className="font-medium">Daily Study Goal</h3>
          </div>

          <div className="p-4 bg-muted/50 rounded-lg space-y-4">
            <div>
              <p className="text-sm text-muted-foreground mb-4">
                Number of new cards to review each day
              </p>

              <Slider
                min={5}
                max={100}
                step={5}
                value={[dailyGoal]}
                onValueChange={(value) => setDailyGoal(value[0])}
                className="w-full"
                aria-label="Daily study goal slider"
              />
            </div>

            <div className="flex items-center justify-between">
              <span className="text-sm text-muted-foreground">Goal:</span>
              <span className="text-lg font-semibold text-foreground">
                {dailyGoal} cards per day
              </span>
            </div>
          </div>
        </div>
      </CardContent>
    </Card>
  );
}
```

---

## Testing Checklist

### Functional Tests

**Daily Goal Slider**:
- [ ] Slider moves smoothly from 5 to 100
- [ ] Slider only allows values in steps of 5 (5, 10, 15, ..., 95, 100)
- [ ] Value display updates in real-time as slider moves
- [ ] Default value is 20 cards if no preference set
- [ ] Slider starts at user's saved preference value
- [ ] Arrow keys work (Left/Down decrease, Right/Up increase)
- [ ] Home key jumps to minimum (5)
- [ ] End key jumps to maximum (100)

**Auto-Save Functionality**:
- [ ] Moving slider starts 1-second debounce timer
- [ ] Rapidly moving slider resets timer (doesn't trigger multiple saves)
- [ ] After 1 second of inactivity, auto-save triggers
- [ ] Success toast appears with correct daily goal value
- [ ] Preference updates in authStore.user.preferences.dailyGoal
- [ ] Preference persists in localStorage
- [ ] After page refresh, slider shows saved value
- [ ] Changing slider to same value as current doesn't trigger save

**Optional Saving Indicator**:
- [ ] Spinner appears next to value during save
- [ ] Spinner disappears after save completes
- [ ] Spinner animates (spins)

### Error Handling Tests

**Auto-Save Errors**:
- [ ] Network error shows destructive toast
- [ ] Error toast displays descriptive message
- [ ] Slider remains at user-selected value (not reverted)
- [ ] User can try again by adjusting slider

**Edge Cases**:
- [ ] Setting goal to minimum (5) saves correctly
- [ ] Setting goal to maximum (100) saves correctly
- [ ] Rapidly changing value many times only saves once
- [ ] Switching pages mid-save doesn't cause errors

### Responsive Tests

**Mobile (375px)**:
- [ ] Slider is full-width and tappable
- [ ] Slider thumb is easy to grab (sufficient touch target)
- [ ] Value display remains readable
- [ ] No horizontal scroll

**Tablet (768px)**:
- [ ] Layout adapts naturally
- [ ] No excessive whitespace

**Desktop (1024px+)**:
- [ ] Container respects max-width constraint
- [ ] Slider doesn't stretch excessively

### Accessibility Tests

**Keyboard Navigation**:
- [ ] Tab key focuses slider
- [ ] Arrow keys adjust value
- [ ] Home/End keys jump to min/max
- [ ] Focus ring visible on slider thumb

**Screen Reader**:
- [ ] Slider has descriptive aria-label
- [ ] Current value is announced when changed
- [ ] Role="slider" is properly set (Shadcn handles this)

**ARIA Attributes**:
- [ ] aria-label="Daily study goal slider" is present
- [ ] aria-valuenow reflects current value
- [ ] aria-valuemin="5" and aria-valuemax="100" are set

---

## Documentation Updates

### settings-components.md

Add AppPreferencesSection documentation after AccountSection (shown in Code Examples section above).

**Key Points to Document**:
- Purpose: Daily goal customization
- Auto-save pattern with debounce explanation
- Integration with authStore
- Slider configuration (range, step, default)
- Error handling approach
- Accessibility features

---

## Success Criteria (Final Checklist)

### Implementation Complete

- [ ] Slider component installed (if not already present)
- [ ] AppPreferencesSection.tsx component created (~80 lines)
- [ ] index.ts barrel export updated
- [ ] Settings.tsx page updated with AppPreferencesSection
- [ ] Documentation updated in settings-components.md

### Functional Requirements

**Daily Goal Slider**:
- [ ] Slider range: 5-100 cards
- [ ] Step size: 5 cards
- [ ] Default value: 20 cards
- [ ] Live value preview displays "{X} cards per day"
- [ ] Keyboard accessible (arrow keys work)
- [ ] Touch-friendly on mobile

**Auto-Save**:
- [ ] Changes auto-save 1 second after slider stops moving
- [ ] Debounce prevents multiple rapid saves
- [ ] Success toast notification appears
- [ ] Preferences persist in localStorage via authStore
- [ ] Optional saving indicator works (if implemented)

**Visual Design**:
- [ ] Matches AccountSection Card styling
- [ ] Clean, minimal UI
- [ ] Consistent spacing and typography
- [ ] Section header with Settings icon

### Quality Requirements

**TypeScript**:
- [ ] 0 TypeScript compilation errors
- [ ] Proper type inference
- [ ] No `any` types

**Testing**:
- [ ] Auto-save tested with debounce
- [ ] Slider tested with keyboard, mouse, touch
- [ ] Edge cases tested (min, max, rapid changes)
- [ ] Error handling tested

**Responsive Design**:
- [ ] Mobile (375px) tested and working
- [ ] Tablet (768px) tested and working
- [ ] Desktop (1024px+) tested and working
- [ ] No horizontal scroll at any breakpoint

**Accessibility**:
- [ ] Keyboard navigation works
- [ ] ARIA labels present
- [ ] Focus management correct

### Build Verification

- [ ] `npm run type-check` passes
- [ ] `npm run build` succeeds
- [ ] No console errors in browser
- [ ] No runtime warnings

---

## Notes for Executor

### Important Considerations

1. **Slider Component**: Check if `slider.tsx` exists in `src/components/ui/`. If not, install it with `npx shadcn-ui@latest add slider` before starting.

2. **DailyGoal Units**: The existing `UserPreferences.dailyGoal` is documented as "minutes" in `auth.ts`, but for Task 08.02 we're treating it as **cards per day**. This is intentional for MVP simplification. The numeric value is stored the same way; only the UI interpretation changes.

3. **Auto-Save Pattern**: The debounce pattern is crucial. Without it, every slider movement would trigger a save (bad UX and performance). The 1-second delay strikes a balance between responsiveness and efficiency.

4. **No Save Button**: Unlike traditional forms, there's no explicit "Save" button. This follows modern UX patterns (Google Docs, Notion, etc.) where changes auto-save. Users should understand this through the toast notification.

5. **Initial Value Handling**: The useEffect skip logic (`if (dailyGoal === user?.preferences?.dailyGoal) return;`) prevents a save on component mount. Without this, opening Settings would trigger an unnecessary save.

6. **Optional Saving Indicator**: The spinner next to the value is optional. It provides subtle feedback but isn't critical. If time is tight, skip it and use the toast alone.

### Common Pitfalls to Avoid

1. **Don't forget to check Slider is installed**: The component won't render without it. Run the install command if needed.

2. **Debounce cleanup**: The `return () => clearTimeout(timer)` cleanup in useEffect is critical. Without it, you'll have memory leaks and stale timers.

3. **Type safety with Slider value**: The Slider component's `value` prop expects an array (`value={[dailyGoal]}`), and `onValueChange` returns an array. Don't forget the array bracket syntax.

4. **Toast timing**: Ensure the toast appears AFTER the save succeeds, not before. The current implementation handles this with async/await.

5. **User experience**: Test the debounce timing. 1 second feels right for most users, but if it feels too slow or too fast during testing, adjust it.

### Next Steps After Task 08.02

After completing this task, you'll move to:

1. **Task 08.03**: Danger Zone Section (delete account, reset progress)
2. **Task 08.04**: Integration & Testing (verify all sections work together)

The AppPreferencesSection adds user-facing customization to complement the account management in Task 08.01.

---

## Dependencies on Other Tasks

### Required (Task 08.01 - Account Settings Section)

**Status**: ✅ COMPLETED

**Why Required**:
- Establishes the Settings page structure
- Demonstrates the Card-based section pattern
- Provides authStore integration example

**Components/Patterns Used**:
- Card layout styling (`bg-muted/50`, `space-y-6`)
- Section header pattern (icon + text)
- authStore integration with updateProfile
- Toast notification patterns

### Required (Shadcn/ui Components)

**Status**: ✅ Card, Badge, Button already installed

**Components Needed**:
- **Slider**: ⚠️ May need installation
  - Check: `src/components/ui/slider.tsx`
  - Install: `npx shadcn-ui@latest add slider`

### Required (Form Components)

**Status**: ✅ Already available

**Components Used**:
- Toast notifications (useToast hook)
- Card components (CardHeader, CardContent, etc.)

---

## Estimated Completion Time

**Total Duration**: 30 minutes

**Breakdown**:
- Install Slider component: 2 min
- Update authStore (if needed): 5 min (may be skipped if updateProfile works)
- Create component shell: 3 min
- Implement slider: 10 min
- Implement auto-save: 7 min
- Integration: 2 min
- Testing: 3 min
- Documentation: 3 min

**Note**: This estimate assumes Slider component installs quickly and no unexpected authStore issues. First-time implementation may take 35-40 minutes.

---

## Final Notes

This task establishes user preference customization in a frictionless way. The auto-save pattern removes the cognitive burden of remembering to save, encouraging users to experiment with their daily goal settings. The slider UI is intuitive and provides immediate visual feedback.

The implementation prioritizes:
1. **Simplicity**: Single preference (daily goal) keeps scope manageable
2. **User Experience**: Auto-save with debounce provides seamless interaction
3. **Code Reuse**: Follows AccountSection patterns for consistency
4. **Maintainability**: Clean component structure, proper TypeScript typing

Upon completion, users will have a streamlined way to customize their learning experience without complexity. This sets the foundation for future preference additions (notifications, theme, language) in post-MVP iterations.

---

**End of Task 08.02 Document**
